<Activity mc:Ignorable="sap sap2010" x:Class="Main" mva:VisualBasic.Settings="{x:Null}" sap:VirtualizedContainerService.HintSize="654,848.5" sap2010:WorkflowViewState.IdRef="Main_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:rc="clr-namespace:Reusable_Components.Chrome;assembly=Reusable_Components" xmlns:rm="clr-namespace:Reusable_Components.MyHR;assembly=Reusable_Components" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <sco:Collection x:TypeArguments="x:String">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>System.Globalization</x:String>
    </sco:Collection>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Plugin.Workflow</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <StateMachine InitialState="{x:Reference __ReferenceID2}" DisplayName="Framework" sap:VirtualizedContainerService.HintSize="614,728.5" sap2010:WorkflowViewState.IdRef="StateMachine_1">
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
        <av:Point x:Key="ShapeLocation">240,2.5</av:Point>
        <x:Double x:Key="StateContainerWidth">600</x:Double>
        <x:Double x:Key="StateContainerHeight">692.46650717703369</x:Double>
        <av:PointCollection x:Key="ConnectorLocation">270,77.5 270,110</av:PointCollection>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <State x:Name="__ReferenceID2" DisplayName="Initialise" sap:VirtualizedContainerService.HintSize="384,2926" sap2010:WorkflowViewState.IdRef="State_4">
      <State.Entry>
        <Sequence DisplayName="Initialise" sap:VirtualizedContainerService.HintSize="358,2562" sap2010:WorkflowViewState.IdRef="Sequence_3">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Sequence DisplayName="Comment/Description - PLEASE READ" sap:VirtualizedContainerService.HintSize="336,52" sap2010:WorkflowViewState.IdRef="Sequence_15">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ui:Comment sap:VirtualizedContainerService.HintSize="314,536" sap2010:WorkflowViewState.IdRef="Comment_1" Text="Use this state to intialise constants such as file paths, file names etc that will need to be used across multiple components. Try to keep as many of the variables as you can limited to the individual components (e.g. a url for a component loging into a website only used once should be limited to that component).&#xA;&#xA;You should also close any applciations that you will be using for the process such as Chrome, SAP, Excel etc in order to start on a clean slate.&#xA;&#xA;The boolInitComplete variable is used in the transition, it's up to you to leave it as is or define a scenario where the initialisation has completed.&#xA;&#xA;PLEASE NOTE&#xA;&#xA;- intMaxRetries should be set to a desired amount of retries you wish the process to make&#xA;-Exception bool values (boolExceptionThrown and boolBusinessExceptionThrown) are reset to False at this stage" />
          </Sequence>
          <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="336,93" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Info" Message="[&quot;Starting State: Initialise.&quot;]">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:LogMessage>
          <Sequence DisplayName="Assign Constants" sap:VirtualizedContainerService.HintSize="336,1867" sap2010:WorkflowViewState.IdRef="Sequence_1">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_151">
              <Assign.To>
                <OutArgument x:TypeArguments="x:Int32">[intCommentCount]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:Int32">0</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_152">
              <Assign.To>
                <OutArgument x:TypeArguments="x:Int32">[intEmailsSent]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:Int32">0</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_150">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strCCEmail]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">joanna.murphy@edfenergy.com</InArgument>
              </Assign.Value>
            </Assign>
            <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="CommentOut_62">
              <ui:CommentOut.Body>
                <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="264,184" sap2010:WorkflowViewState.IdRef="Sequence_211">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_163">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[strCCEmail]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">ugis.laimins@edfenergy.com</InArgument>
                    </Assign.Value>
                  </Assign>
                </Sequence>
              </ui:CommentOut.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:CommentOut>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_1">
              <Assign.To>
                <OutArgument x:TypeArguments="x:Int32">[intMaxRetries]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:Int32">3</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_11">
              <Assign.To>
                <OutArgument x:TypeArguments="x:Int32">[intTransactionID]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:Int32">1</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_101">
              <Assign.To>
                <OutArgument x:TypeArguments="x:Int32">[intTransactionCount]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:Int32">1</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_2">
              <Assign.To>
                <OutArgument x:TypeArguments="x:Boolean">[boolBusinessRuleExceptionThrown]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:Boolean">False</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_3">
              <Assign.To>
                <OutArgument x:TypeArguments="x:Boolean">[boolExceptionThrown]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:Boolean">False</InArgument>
              </Assign.Value>
            </Assign>
            <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="CommentOut_44">
              <ui:CommentOut.Body>
                <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="264,184" sap2010:WorkflowViewState.IdRef="Sequence_175">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_13">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[strFolderPath]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">S:\Grosvenor\Employee Services\ES Immigration\Immigration\Robotics</InArgument>
                    </Assign.Value>
                  </Assign>
                </Sequence>
              </ui:CommentOut.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:CommentOut>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_147">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strFolderPath]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">C:\Users\laimi1u\Desktop\Immigration and Visa Checks\Files</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_15">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strReportsFolderPath]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[strFolderPath+"\Reports"]</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_14">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strTemplatePath]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[strFolderPath+"\Templates\SF16 Visa Residency Status Report - With Analysis - Template.xlsm"]</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_16">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strReportPath]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[strReportsFolderPath+"\SF16 Visa Residency Status Report - New Data.xlsx"]</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_17">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strReportWithAnalysisPath]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[strReportsFolderPath+"\SF16 Visa Residency Status Report - With Analysis.xlsm"]</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_19">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strPreviousReportPath]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[strReportsFolderPath+"\Previous Report.xlsm"]</InArgument>
              </Assign.Value>
            </Assign>
            <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_18">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strArchiveFolderPath]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[strReportsFolderPath+"\Archive\"+now.ToString("dd MM yy")]</InArgument>
              </Assign.Value>
            </Assign>
            <ui:GetEnvironmentVariable DisplayName="Get Environment Variable" sap:VirtualizedContainerService.HintSize="314,59" sap2010:WorkflowViewState.IdRef="GetEnvironmentVariable_1" Variable="UserName" VariableValue="[strUsername]" />
          </Sequence>
          <Sequence DisplayName="Close Applications" sap:VirtualizedContainerService.HintSize="336,52" sap2010:WorkflowViewState.IdRef="Sequence_2">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="416,254" sap2010:WorkflowViewState.IdRef="CommentOut_3">
              <ui:CommentOut.Body>
                <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="222,176" sap2010:WorkflowViewState.IdRef="Sequence_45">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:CloseApplication ContinueOnError="True" DisplayName="Close Chrome" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="CloseApplication_1">
                    <ui:CloseApplication.Target>
                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="5f4e8afd5ceb78345b25d72b0e11c4de" Selector="&lt;html app='chrome.exe' title='*' /&gt;" TimeoutMS="5000" WaitForReady="INTERACTIVE" />
                    </ui:CloseApplication.Target>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:CloseApplication>
                </Sequence>
              </ui:CommentOut.Body>
            </ui:CommentOut>
          </Sequence>
          <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="336,52" sap2010:WorkflowViewState.IdRef="CommentOut_33">
            <ui:CommentOut.Body>
              <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="380,1142" sap2010:WorkflowViewState.IdRef="Sequence_138">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Sequence DisplayName="Download Report" sap:VirtualizedContainerService.HintSize="719,52" sap2010:WorkflowViewState.IdRef="Sequence_19">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <rm:My_HR_Login DisplayName="My HR Login" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="My_HR_Login_1" strUsername="droid1a" />
                  <rc:Handle_Restore_Pages_Popup DisplayName="Handle Restore Pages Popup" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Handle_Restore_Pages_Popup_1" />
                  <rm:MyHR___Navigate_to_Reports DisplayName="MyHR - Navigate to Reports" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MyHR___Navigate_to_Reports_1" />
                  <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke MyHR - DownloadRepor workflow" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_1" UnSafe="False" WorkflowFileName="MyHR - Download Report.xaml">
                    <ui:InvokeWorkflowFile.Arguments>
                      <InArgument x:TypeArguments="x:String" x:Key="in_strReportName">SF16</InArgument>
                    </ui:InvokeWorkflowFile.Arguments>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:InvokeWorkflowFile>
                  <rm:MyHR___Logout DisplayName="MyHR - Logout" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MyHR___Logout_1" />
                </Sequence>
                <Sequence DisplayName="Move and Copy Files" sap:VirtualizedContainerService.HintSize="719,926" sap2010:WorkflowViewState.IdRef="Sequence_26">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Sequence DisplayName="Create Archive Directory" sap:VirtualizedContainerService.HintSize="336,306" sap2010:WorkflowViewState.IdRef="Sequence_33">
                    <Sequence.Variables>
                      <Variable x:TypeArguments="x:Boolean" Name="boolArchiveFolderExists" />
                    </Sequence.Variables>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:PathExists DisplayName="Path Exists" Exists="[boolArchiveFolderExists]" sap:VirtualizedContainerService.HintSize="314,90" sap2010:WorkflowViewState.IdRef="PathExists_1" Path="[strArchiveFolderPath]" PathType="Folder" />
                    <If Condition="[NOT boolArchiveFolderExists]" DisplayName="If Archive Folder Doesn't Exist, Create it" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="If_1">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If.Then>
                        <Sequence DisplayName="Create Archive Folder" sap:VirtualizedContainerService.HintSize="336,279" sap2010:WorkflowViewState.IdRef="Sequence_32">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_21" Level="Info" Message="[&quot;Creating Archive Folder.&quot;]" />
                          <ui:CreateDirectory ContinueOnError="{x:Null}" DisplayName="Create Directory" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="CreateDirectory_1" Path="[strArchiveFolderPath]" />
                        </Sequence>
                      </If.Then>
                      <If.Else>
                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_22" Level="Info" Message="[&quot;Archive Folder Already Exists.&quot;]" />
                      </If.Else>
                    </If>
                  </Sequence>
                  <Sequence DisplayName="Copy Files to Archive Folder" sap:VirtualizedContainerService.HintSize="336,456" sap2010:WorkflowViewState.IdRef="Sequence_34">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:CopyFile ContinueOnError="True" Destination="[strArchiveFolderPath+&quot;\Previous Report - &quot;+now.ToString(&quot;dd MM yy&quot;)+&quot;.xlsm&quot;]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="CopyFile_4" Overwrite="True" Path="[strPreviousReportPath]" />
                    <ui:CopyFile ContinueOnError="True" Destination="[strPreviousReportPath]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="CopyFile_5" Overwrite="True" Path="[strReportWithAnalysisPath]" />
                    <ui:MoveFile ContinueOnError="True" Destination="[strArchiveFolderPath+&quot;\SF16 Visa Residency Status Report - With Analysis - &quot;+now.ToString(&quot;dd MM yy&quot;)+&quot;.xlsm&quot;]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_3" Overwrite="True" Path="[strReportWithAnalysisPath]" />
                    <ui:MoveFile ContinueOnError="True" Destination="[strArchiveFolderPath+&quot;\SF16 Visa Residency Status Report - New Data - &quot;+now.ToString(&quot;dd MM yyyy&quot;)+&quot;.xlsx&quot;]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_2" Overwrite="True" Path="[strReportPath]" />
                    <ui:MoveFile ContinueOnError="True" Destination="[strReportPath]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_4" Overwrite="True" Path="[&quot;C:\Users\&quot;+strUsername+&quot;\Downloads\SF16-VisaResidencyStatusReport-Component9.xlsx&quot;]" />
                    <ui:CopyFile ContinueOnError="True" Destination="[strReportWithAnalysisPath]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="CopyFile_6" Overwrite="True" Path="[strTemplatePath]" />
                  </Sequence>
                </Sequence>
              </Sequence>
            </ui:CommentOut.Body>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:CommentOut>
          <ui:CopyFile ContinueOnError="True" Destination="[strReportWithAnalysisPath]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="336,22" sap2010:WorkflowViewState.IdRef="CopyFile_7" Overwrite="True" Path="[strTemplatePath]" />
          <Assign sap:VirtualizedContainerService.HintSize="336,60" sap2010:WorkflowViewState.IdRef="Assign_4">
            <Assign.To>
              <OutArgument x:TypeArguments="x:Boolean">[boolInitComplete]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:Boolean">True</InArgument>
            </Assign.Value>
          </Assign>
        </Sequence>
      </State.Entry>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">189,110</av:Point>
          <av:Size x:Key="ShapeSize">162,80</av:Size>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
          <x:Double x:Key="StateContainerWidth">148</x:Double>
          <x:Double x:Key="StateContainerHeight">44</x:Double>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <State.Transitions>
        <Transition DisplayName="Init Success" sap:VirtualizedContainerService.HintSize="430,512" sap2010:WorkflowViewState.IdRef="Transition_6">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:PointCollection x:Key="ConnectorLocation">270,190 270,253</av:PointCollection>
              <x:Int32 x:Key="SrcConnectionPointIndex">39</x:Int32>
              <x:Int32 x:Key="DestConnectionPointIndex">38</x:Int32>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Transition.To>
            <State x:Name="__ReferenceID1" DisplayName="Get Data" sap:VirtualizedContainerService.HintSize="157,114" sap2010:WorkflowViewState.IdRef="State_3">
              <State.Entry>
                <TryCatch sap:VirtualizedContainerService.HintSize="454,1583" sap2010:WorkflowViewState.IdRef="TryCatch_1">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <TryCatch.Try>
                    <Sequence DisplayName="Get Required Data" sap:VirtualizedContainerService.HintSize="436,1328" sap2010:WorkflowViewState.IdRef="Sequence_4">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="414,93" sap2010:WorkflowViewState.IdRef="LogMessage_17" Level="Info" Message="[&quot;Starting State: Get Data&quot;]" />
                      <Sequence DisplayName="Comment/Description" sap:VirtualizedContainerService.HintSize="414,52" sap2010:WorkflowViewState.IdRef="Sequence_16">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:Comment sap:VirtualizedContainerService.HintSize="314,536" sap2010:WorkflowViewState.IdRef="Comment_2" Text="Get Data state should be used to gather the required data such as extracting a report from a website or SAP. You should not be processing the data in this state as to keep the two processes seperate.&#xA;&#xA;Any components invoked here should be built to throw either a business exception or normal exception which will be caught by this states Try Catch.&#xA;&#xA;Business Exceptions should be thrown when there is an issue with the application or data that is not the fault/error of the robot such as the report not existing in the specified system or robot not having access right to part of the system. As these are bussiness exception, these should usually be directed towards the process owners.&#xA;&#xA;Normal exceptions cover everything else, such as robot error or unexpected issues that should be caught, logged and emailed to the rpa mailbox.&#xA;&#xA;This state has three transitions currently, one which will occur on success, one which will occur if there is an error and another which will occur if either max retires is reached or an exception is thrown. On success, the process should transition to the next state. On error, the state should return back to initialisation state and retry the process. On max retries or exception, the process should throw the exception and then go to final state to clean up the enivronment in use.&#xA;&#xA;You are responsible for defining the intMaxRetries (default being 3) variable in the Initialisation state as well as setting the correct transition conditions." />
                      </Sequence>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="414,93" sap2010:WorkflowViewState.IdRef="LogMessage_16" Level="Info" Message="[&quot;Transaction ID: &quot;+intTransactionID.ToString]" />
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="414,93" sap2010:WorkflowViewState.IdRef="LogMessage_40" Level="Info" Message="[strReportPath]" />
                      <ui:ReadRange AddHeaders="True" DataTable="[dtSF16Data]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="414,87" sap2010:WorkflowViewState.IdRef="ReadRange_1" Range="A3" SheetName="Excel Output" WorkbookPath="[strReportPath]">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:ReadRange>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="414,93" sap2010:WorkflowViewState.IdRef="LogMessage_41" Level="Info" Message="[strPreviousReportPath]" />
                      <ui:ExcelApplicationScope Password="{x:Null}" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="414,391" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_2" WorkbookPath="[strPreviousReportPath]">
                        <ui:ExcelApplicationScope.Body>
                          <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_37">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:ExcelReadRange AddHeaders="True" DataTable="[dtOLDSF16]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="314,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_8" Range="A1" SheetName="SF16" />
                              <ui:ExcelReadRange AddHeaders="True" DataTable="[dtOLDLimitedLeave]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="314,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_12" Range="A1" SheetName="Limited Leave" />
                            </Sequence>
                          </ActivityAction>
                        </ui:ExcelApplicationScope.Body>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:ExcelApplicationScope>
                      <ui:KillProcess Process="{x:Null}" ContinueOnError="True" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="414,22" sap2010:WorkflowViewState.IdRef="KillProcess_1" ProcessName="excel" />
                    </Sequence>
                  </TryCatch.Try>
                  <TryCatch.Catches>
                    <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="440,22" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Business Rule Exception" sap:VirtualizedContainerService.HintSize="336,317" sap2010:WorkflowViewState.IdRef="Sequence_5">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="Info" Message="[&quot;Business Exception Thrown: &quot;+exception.Message]" />
                          <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_5">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:Boolean">[boolBusinessRuleExceptionThrown]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                            </Assign.Value>
                          </Assign>
                        </Sequence>
                      </ActivityAction>
                    </Catch>
                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="440,22" sap2010:WorkflowViewState.IdRef="Catch`1_2">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="s:Exception">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Exception" sap:VirtualizedContainerService.HintSize="336,317" sap2010:WorkflowViewState.IdRef="Sequence_6">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_3" Level="Info" Message="[&quot;Exception Thrown: &quot;+exception.Message]" />
                          <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_6">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:Boolean">[boolExceptionThrown]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                            </Assign.Value>
                          </Assign>
                        </Sequence>
                      </ActivityAction>
                    </Catch>
                  </TryCatch.Catches>
                </TryCatch>
              </State.Entry>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">191.5,253</av:Point>
                  <av:Size x:Key="ShapeSize">157,114</av:Size>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <x:Double x:Key="StateContainerWidth">143</x:Double>
                  <x:Double x:Key="StateContainerHeight">78</x:Double>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <State.Transitions>
                <Transition DisplayName="Success" sap:VirtualizedContainerService.HintSize="430,619" sap2010:WorkflowViewState.IdRef="Transition_3">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:PointCollection x:Key="ConnectorLocation">270,367 270,422</av:PointCollection>
                      <x:Int32 x:Key="SrcConnectionPointIndex">39</x:Int32>
                      <x:Int32 x:Key="DestConnectionPointIndex">38</x:Int32>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Transition.To>
                    <State x:Name="__ReferenceID3" DisplayName="Process Data" sap:VirtualizedContainerService.HintSize="151.5,116" sap2010:WorkflowViewState.IdRef="State_2">
                      <State.Entry>
                        <TryCatch sap:VirtualizedContainerService.HintSize="921,7320" sap2010:WorkflowViewState.IdRef="TryCatch_2">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <TryCatch.Try>
                            <Sequence DisplayName="Process Data" sap:VirtualizedContainerService.HintSize="903,7065" sap2010:WorkflowViewState.IdRef="Sequence_7">
                              <Sequence.Variables>
                                <Variable x:TypeArguments="x:Int32" Name="intIndex" />
                              </Sequence.Variables>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Sequence DisplayName="Comment/Description - PLEASE READ" sap:VirtualizedContainerService.HintSize="881,52" sap2010:WorkflowViewState.IdRef="Sequence_17">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:Comment sap:VirtualizedContainerService.HintSize="314,536" sap2010:WorkflowViewState.IdRef="Comment_3" Text="The following state is used to process the data gathered in the previous state. &#xA;&#xA;Same exception handling should apply here however it might be slightly different as it will cover data errors.&#xA;&#xA;There is currently only two states. One that leads to the processes finishing and another for capturing exceptions. It is up to you, process specific, to define any other states for the process (e.g. restarting the whole process if data is too old.)&#xA;&#xA;There are two types of exceptions that should be used:&#xA;&#xA;- Normal exception which is used to highlight and throw process specific errors such as emails not sending or not being able to open file. Syntax: new exception(&quot;exception message&quot;).&#xA;- BusinessRuleException which is used to highlight specific issues regarding the thing such as not all files exist in the directory, the data is in the wrong format etc. BusinessRuleExceptions should usually be directly higlighted to the business/process owner. Syntax: new BusinessRuleException(&quot;exception message&quot;)." />
                              </Sequence>
                              <ui:LogMessage sap:VirtualizedContainerService.HintSize="881,93" sap2010:WorkflowViewState.IdRef="LogMessage_4" Level="Info" Message="[&quot;Starting State: Process State&quot;]" />
                              <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" DisplayName="Excel Application Scope - Report With Analysis" sap:VirtualizedContainerService.HintSize="881,6616" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_4" WorkbookPath="[strReportWithAnalysisPath]">
                                <ui:ExcelApplicationScope.Body>
                                  <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="867,6507" sap2010:WorkflowViewState.IdRef="Sequence_77">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:WindowScope ApplicationWindow="{x:Null}" SearchScope="{x:Null}" TimeoutMS="{x:Null}" Window="{x:Null}" DisplayName="Attach Window 'EXCEL.EXE SF16'" sap:VirtualizedContainerService.HintSize="845,52" sap2010:WorkflowViewState.IdRef="WindowScope_1" InformativeScreenshot="1aca1f29971bbe751f1e67e74225019a" Selector="&lt;wnd app='excel.exe' cls='XLMAIN' title='SF16 Visa Residency Status Report - With Analysis.xlsm - Excel' /&gt;">
                                        <ui:WindowScope.Body>
                                          <ActivityAction x:TypeArguments="x:Object">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                            </ActivityAction.Argument>
                                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="222,146" sap2010:WorkflowViewState.IdRef="Sequence_180">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:MaximizeWindow Window="{x:Null}" DisplayName="Maximize Window" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MaximizeWindow_1" />
                                            </Sequence>
                                          </ActivityAction>
                                        </ui:WindowScope.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:WindowScope>
                                      <ui:ExcelWriteRange AddHeaders="False" DataTable="[dtSF16Data]" DisplayName="Write SF16 Report Data" sap:VirtualizedContainerService.HintSize="845,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_6" SheetName="SF16" StartingCell="A2" />
                                      <ui:ExcelReadRange AddHeaders="True" DataTable="[dtSF16Data]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="845,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_10" Range="A1" SheetName="SF16">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:ExcelReadRange>
                                      <Sequence DisplayName="Create ILR.PR sheet" sap:VirtualizedContainerService.HintSize="845,52" sap2010:WorkflowViewState.IdRef="Sequence_76">
                                        <Sequence.Variables>
                                          <Variable x:TypeArguments="sd:DataTable" Name="dtILRPRCopy" />
                                          <Variable x:TypeArguments="sd:DataTable" Name="dtNewILRPRCopy" />
                                          <Variable x:TypeArguments="scg:List(x:Int32)" Name="arrRowsToDelete" />
                                        </Sequence.Variables>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="LogMessage_33" Level="Info" Message="[&quot;Creating ILR.PR sheet&quot;]">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:LogMessage>
                                        <ui:FilterDataTable sap2010:Annotation.AnnotationText="We filter the SF16 report data for the ILR and PR visa types." DataTable="[dtSF16Data]" DisplayName="Filter SF16 for ILR.PR data" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="314,103" sap2010:WorkflowViewState.IdRef="FilterDataTable_1" OutputDataTable="[dtNewILRPR]" SelectColumnsMode="Keep">
                                          <ui:FilterDataTable.Filters>
                                            <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                              <ui:FilterOperationArgument BooleanOperator="And" Operator="CONTAINS">
                                                <ui:FilterOperationArgument.Column>
                                                  <InArgument x:TypeArguments="x:String">["Type (Label)"]</InArgument>
                                                </ui:FilterOperationArgument.Column>
                                                <ui:FilterOperationArgument.Operand>
                                                  <InArgument x:TypeArguments="x:String">["PR: Permanent Residency/Citizenship"]</InArgument>
                                                </ui:FilterOperationArgument.Operand>
                                              </ui:FilterOperationArgument>
                                              <ui:FilterOperationArgument BooleanOperator="Or" Operator="CONTAINS">
                                                <ui:FilterOperationArgument.Column>
                                                  <InArgument x:TypeArguments="x:String">["Type (Label)"]</InArgument>
                                                </ui:FilterOperationArgument.Column>
                                                <ui:FilterOperationArgument.Operand>
                                                  <InArgument x:TypeArguments="x:String">["ILR: Indefinite Leave to Remain"]</InArgument>
                                                </ui:FilterOperationArgument.Operand>
                                              </ui:FilterOperationArgument>
                                            </scg:List>
                                          </ui:FilterDataTable.Filters>
                                          <ui:FilterDataTable.SelectColumns>
                                            <scg:List x:TypeArguments="InArgument" Capacity="4">
                                              <x:Null />
                                            </scg:List>
                                          </ui:FilterDataTable.SelectColumns>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:FilterDataTable>
                                        <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_114">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="s:DateTime">[dateFilter]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="s:DateTime">[new DateTime(9999,12,31)]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="CommentOut_45">
                                          <ui:CommentOut.Body>
                                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="336,259" sap2010:WorkflowViewState.IdRef="Sequence_181">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:FilterDataTable sap2010:Annotation.AnnotationText="We filter the table to show which people are off on sick leave. We identify this by looking at if there is a Sickness Start Date but no Sickness End Date" DataTable="[dtNewILRPR]" DisplayName="Filter Data Table for Visas With Expiry" FilterRowsMode="Remove" sap:VirtualizedContainerService.HintSize="314,135" sap2010:WorkflowViewState.IdRef="FilterDataTable_7" OutputDataTable="[dtNewILRPR]" SelectColumnsMode="Keep">
                                                <ui:FilterDataTable.Filters>
                                                  <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                    <ui:FilterOperationArgument BooleanOperator="And" Operator="GTE">
                                                      <ui:FilterOperationArgument.Column>
                                                        <InArgument x:TypeArguments="x:String">["LTR/Visa Expiry Date"]</InArgument>
                                                      </ui:FilterOperationArgument.Column>
                                                      <ui:FilterOperationArgument.Operand>
                                                        <InArgument x:TypeArguments="s:DateTime">[dateFilter]</InArgument>
                                                      </ui:FilterOperationArgument.Operand>
                                                    </ui:FilterOperationArgument>
                                                    <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="Or" Operator="EMPTY">
                                                      <ui:FilterOperationArgument.Column>
                                                        <InArgument x:TypeArguments="x:String">["LTR/Visa Expiry Date"]</InArgument>
                                                      </ui:FilterOperationArgument.Column>
                                                    </ui:FilterOperationArgument>
                                                  </scg:List>
                                                </ui:FilterDataTable.Filters>
                                                <ui:FilterDataTable.SelectColumns>
                                                  <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                    <x:Null />
                                                  </scg:List>
                                                </ui:FilterDataTable.SelectColumns>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:FilterDataTable>
                                            </Sequence>
                                          </ui:CommentOut.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:CommentOut>
                                        <ui:SortDataTable ColumnName="{x:Null}" DataColumn="{x:Null}" ColumnIndex="[25]" DataTable="[dtNewILRPR]" DisplayName="Sort Data Table" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="SortDataTable_2" Order="Ascending" OutputDataTable="[dtNewILRPR]" />
                                        <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_165">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="sd:DataTable">[dtILRPRCopy]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="sd:DataTable">[dtNewILRPR.Copy]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtILRPRCopy]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="ForEachRow_14">
                                          <ui:ForEachRow.Body>
                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="486,581" sap2010:WorkflowViewState.IdRef="Sequence_185">
                                                <Sequence.Variables>
                                                  <Variable x:TypeArguments="sd:DataRow" Name="rowDataRowToTransfer" />
                                                </Sequence.Variables>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If Condition="[string.IsNullOrEmpty(row(25).ToString)]" sap:VirtualizedContainerService.HintSize="464,457" sap2010:WorkflowViewState.IdRef="If_84">
                                                  <If.Then>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="264,308" sap2010:WorkflowViewState.IdRef="Sequence_184">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_164">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="sd:DataRow">[rowDataRowToTransfer]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="sd:DataRow">[row]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <ui:RemoveDataRow Row="{x:Null}" DataTable="[dtNewILRPR]" DisplayName="Remove Data Row" sap:VirtualizedContainerService.HintSize="242,22" sap2010:WorkflowViewState.IdRef="RemoveDataRow_1" RowIndex="[dtNewILRPR.Rows.IndexOf(row)+1]" />
                                                      <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[rowDataRowToTransfer.ItemArray]" DataTable="[dtNewILRPR]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="242,22" sap2010:WorkflowViewState.IdRef="AddDataRow_3" />
                                                    </Sequence>
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ForEachRow.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ForEachRow>
                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_49" Level="Info" Message="[&quot;Nothing&quot;]" />
                                        <ui:ExcelWriteRange AddHeaders="True" DataTable="[dtNewILRPR]" DisplayName="Write new data to sheet" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_5" SheetName="ILR.PR" StartingCell="A1">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExcelWriteRange>
                                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="CommentOut_52">
                                          <ui:CommentOut.Body>
                                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="336,330" sap2010:WorkflowViewState.IdRef="Sequence_200">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Delay Duration="00:00:02" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delay_2" />
                                              <ui:ExcelReadRange AddHeaders="True" sap2010:Annotation.AnnotationText="We read the sheet as to get the proper headings. The headings in the SF16 has different headers than the actual report." DataTable="[dtNewILRPR]" DisplayName="Read ILR.PR Sheet" sap:VirtualizedContainerService.HintSize="200,144" sap2010:WorkflowViewState.IdRef="ExcelReadRange_5" Range="A1" SheetName="ILR.PR">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ExcelReadRange>
                                            </Sequence>
                                          </ui:CommentOut.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:CommentOut>
                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_28" Level="Info" Message="[&quot;ILR.PR Item Count: &quot;+dtNewILRPR.Rows.Count.ToString]">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:LogMessage>
                                        <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtNewILRPR]" DisplayName="Check ILR.PR Sheet for Changes" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="ForEachRow_1">
                                          <ui:ForEachRow.Body>
                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="825,1279" sap2010:WorkflowViewState.IdRef="Sequence_39">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="803,60" sap2010:WorkflowViewState.IdRef="Assign_27">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">["Robot Comment "+now.ToString("dd MM yy")+":"]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <If Condition="[NOT string.IsNullOrWhitespace(row(25).ToString)]" DisplayName="If Date Cell is not empty" sap:VirtualizedContainerService.HintSize="803,1055" sap2010:WorkflowViewState.IdRef="If_53">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Sequence DisplayName="Cell Not Empty" sap:VirtualizedContainerService.HintSize="678,906" sap2010:WorkflowViewState.IdRef="Sequence_114">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="656,60" sap2010:WorkflowViewState.IdRef="Assign_89">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[strCurrentDate]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[cdate(row(25).ToString).ToString("dd/MM/yyyy")]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <If Condition="[datetime.ParseExact(strCurrentDate,&quot;dd/MM/yyyy&quot;,system.Globalization.CultureInfo.InvariantCulture) &lt;=now.AddMonths(3) AND datetime.ParseExact(strCurrentDate,&quot;dd/MM/yyyy&quot;,system.Globalization.CultureInfo.InvariantCulture) &gt; now.adddays(-7)]" DisplayName="If Expiry Date within 3 months" sap:VirtualizedContainerService.HintSize="656,682" sap2010:WorkflowViewState.IdRef="If_52">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="Expiry within 3 months" sap:VirtualizedContainerService.HintSize="531,533" sap2010:WorkflowViewState.IdRef="Sequence_113">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Assign sap:VirtualizedContainerService.HintSize="509,60" sap2010:WorkflowViewState.IdRef="Assign_90">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">[strComment+vbnewline+"- LTR/Visa Expiry Date in 3 months or less"]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <Assign sap:VirtualizedContainerService.HintSize="509,60" sap2010:WorkflowViewState.IdRef="Assign_153">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Int32">[intCommentCount]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Int32">[intCommentCount+1]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <If Condition="[string.IsNullOrWhiteSpace(row(31).ToString)]" DisplayName="If Comment Field is Empty, just write coment, otherwise add to current comment" sap:VirtualizedContainerService.HintSize="509,209" sap2010:WorkflowViewState.IdRef="If_51">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_91">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Object">[row.Item(31)]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:Object">[strComment]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </If.Then>
                                                              <If.Else>
                                                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_92">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Object">[row.Item(31)]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:Object">[row.Item("Further Comments").ToString+vbnewline+vbnewline+strComment]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </If.Else>
                                                            </If>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                    </Sequence>
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ForEachRow.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ForEachRow>
                                        <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_172">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="sd:DataTable">[dtNewILRPRCopy]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="sd:DataTable">[dtNewILRPR.copy]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_173">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="scg:List(x:Int32)">[arrRowsToDelete]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="scg:List(x:Int32)">[new List(Of Integer)]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtNewILRPR]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="ForEachRow_16">
                                          <ui:ForEachRow.Body>
                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="685,1430" sap2010:WorkflowViewState.IdRef="Sequence_192">
                                                <Sequence.Variables>
                                                  <Variable x:TypeArguments="sd:DataTable" Name="dtDuplicates" />
                                                </Sequence.Variables>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="663,60" sap2010:WorkflowViewState.IdRef="Assign_168">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="sd:DataRow[]">[arrFilteredRows]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="sd:DataRow[]">[dtNewILRPR.Select("[Employee Number] ='"+row(0).ToString+"'")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <If Condition="[arrFilteredRows.Length&gt;1]" sap:VirtualizedContainerService.HintSize="663,1206" sap2010:WorkflowViewState.IdRef="If_87">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="538,1057" sap2010:WorkflowViewState.IdRef="Sequence_191">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="516,60" sap2010:WorkflowViewState.IdRef="Assign_169">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="sd:DataTable">[dtDuplicates]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="sd:DataTable">[arrFilteredRows.CopyToDataTable]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtDuplicates]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="516,833" sap2010:WorkflowViewState.IdRef="ForEachRow_15">
                                                        <ui:ForEachRow.Body>
                                                          <ActivityAction x:TypeArguments="sd:DataRow">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="sd:DataRow" Name="line" />
                                                            </ActivityAction.Argument>
                                                            <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="486,685" sap2010:WorkflowViewState.IdRef="Sequence_190">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If Condition="[row(&quot;Type (Label)&quot;).ToString.Contains(&quot;ILR: Indefinite Leave to Remain&quot;)]" sap:VirtualizedContainerService.HintSize="464,561" sap2010:WorkflowViewState.IdRef="If_86">
                                                                <If.Then>
                                                                  <Sequence sap:VirtualizedContainerService.HintSize="336,412" sap2010:WorkflowViewState.IdRef="Sequence_198">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_47" Level="Info" Message="[&quot;Deleting: &quot;+row(1).ToString]" />
                                                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_48" Level="Info" Message="[&quot;Row Index: &quot;+(dtNewILRPR.Rows.IndexOf(row)+2).ToString]" />
                                                                    <AddToCollection x:TypeArguments="x:Int32" Collection="[arrRowsToDelete]" DisplayName="Add To Collection" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_1" Item="[(dtNewILRPR.Rows.IndexOf(row)+2)]" />
                                                                  </Sequence>
                                                                </If.Then>
                                                              </If>
                                                            </Sequence>
                                                          </ActivityAction>
                                                        </ui:ForEachRow.Body>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:ForEachRow>
                                                    </Sequence>
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ForEachRow.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ForEachRow>
                                        <ui:ExcelWriteRange AddHeaders="True" DataTable="[dtNewILRPR]" DisplayName="Update Report" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_21" SheetName="ILR.PR" StartingCell="A1">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExcelWriteRange>
                                        <InvokeMethod DisplayName="Invoke Method" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="InvokeMethod_3" MethodName="Reverse">
                                          <InvokeMethod.TargetObject>
                                            <InArgument x:TypeArguments="scg:List(x:Int32)">[arrRowsToDelete]</InArgument>
                                          </InvokeMethod.TargetObject>
                                        </InvokeMethod>
                                        <ui:ForEach x:TypeArguments="x:Int32" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="314,280" sap2010:WorkflowViewState.IdRef="ForEach`1_2" Values="[arrRowsToDelete.Distinct]">
                                          <ui:ForEach.Body>
                                            <ActivityAction x:TypeArguments="x:Int32">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="x:Int32" Name="item" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="222,146" sap2010:WorkflowViewState.IdRef="Sequence_206">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:ExcelInsertDeleteRows DisplayName="Insert/Delete Rows" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="ExcelInsertDeleteRows_11" Mode="Remove" NoRows="1" Position="[item]" SheetName="ILR.PR" />
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ForEach.Body>
                                        </ui:ForEach>
                                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="CommentOut_50">
                                          <ui:CommentOut.Body>
                                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="655,1318" sap2010:WorkflowViewState.IdRef="Sequence_197">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Sequence sap2010:Annotation.AnnotationText="We have to take this approach to deleting empty lines as to preserve the coloured cells." DisplayName="Remove Duplicates" sap:VirtualizedContainerService.HintSize="633,1194" sap2010:WorkflowViewState.IdRef="Sequence_196">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="611,60" sap2010:WorkflowViewState.IdRef="Assign_170">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:Int32">[intIndex]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:Int32">[dtNewILRPR.Rows.Count-1]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <While DisplayName="While Rows Exist" sap:VirtualizedContainerService.HintSize="611,942" sap2010:WorkflowViewState.IdRef="While_6">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <While.Condition>[intIndex &gt;= 0]</While.Condition>
                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="585,783" sap2010:WorkflowViewState.IdRef="Sequence_195">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If Condition="[cdate(dtNewLimitedLeave.Rows(intIndex).Item(&quot;LTR/Visa Expiry Date&quot;).ToString)&lt;now AND string.IsNullOrWhiteSpace(dtNewLimitedLeave.Rows(intIndex).Item(&quot;Further Comments&quot;).ToString)]" DisplayName="If Further Comments are empty, then delete the row" sap:VirtualizedContainerService.HintSize="563,559" sap2010:WorkflowViewState.IdRef="If_88">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If.Then>
                                                        <Sequence sap:VirtualizedContainerService.HintSize="438,410" sap2010:WorkflowViewState.IdRef="Sequence_194">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:ExcelSetRangeColor Color="[system.Drawing.Color.Yellow]" DisplayName="Set Range Color" sap:VirtualizedContainerService.HintSize="416,22" sap2010:WorkflowViewState.IdRef="ExcelSetRangeColor_18" Range="[&quot;A&quot;+(intindex+2).ToString+&quot;:AJ&quot;+(intindex+2).ToString]" SheetName="Limited Leave" />
                                                          <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="416,224" sap2010:WorkflowViewState.IdRef="CommentOut_49">
                                                            <ui:CommentOut.Body>
                                                              <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="222,146" sap2010:WorkflowViewState.IdRef="Sequence_193">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:ExcelInsertDeleteRows DisplayName="Insert/Delete Rows" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="ExcelInsertDeleteRows_8" Mode="Remove" NoRows="1" Position="[intIndex+2]" SheetName="Limited Leave" />
                                                              </Sequence>
                                                            </ui:CommentOut.Body>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </ui:CommentOut>
                                                        </Sequence>
                                                      </If.Then>
                                                    </If>
                                                    <Assign sap:VirtualizedContainerService.HintSize="563,60" sap2010:WorkflowViewState.IdRef="Assign_171">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:Int32">[intIndex]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:Int32">[intIndex-1]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                  </Sequence>
                                                </While>
                                              </Sequence>
                                            </Sequence>
                                          </ui:CommentOut.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:CommentOut>
                                      </Sequence>
                                      <Sequence DisplayName="Create Limited Leave sheet" sap:VirtualizedContainerService.HintSize="845,52" sap2010:WorkflowViewState.IdRef="Sequence_80">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_34" Level="Info" Message="[&quot;Creating Limited Leave sheet&quot;]">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:LogMessage>
                                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="CommentOut_39">
                                          <ui:CommentOut.Body>
                                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="336,259" sap2010:WorkflowViewState.IdRef="Sequence_144">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:FilterDataTable sap2010:Annotation.AnnotationText="We filter the table to show which people are off on sick leave. We identify this by looking at if there is a Sickness Start Date but no Sickness End Date" DataTable="[dtSF16Data]" DisplayName="Filter Data Table for Sickness" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="314,135" sap2010:WorkflowViewState.IdRef="FilterDataTable_8" OutputDataTable="[dtNewLimitedLeave]" SelectColumnsMode="Keep">
                                                <ui:FilterDataTable.Filters>
                                                  <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                    <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="EMPTY">
                                                      <ui:FilterOperationArgument.Column>
                                                        <InArgument x:TypeArguments="x:String">["Last Date of Sickness"]</InArgument>
                                                      </ui:FilterOperationArgument.Column>
                                                    </ui:FilterOperationArgument>
                                                    <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="NOTEMPTY">
                                                      <ui:FilterOperationArgument.Column>
                                                        <InArgument x:TypeArguments="x:String">["Start date of sickness"]</InArgument>
                                                      </ui:FilterOperationArgument.Column>
                                                    </ui:FilterOperationArgument>
                                                  </scg:List>
                                                </ui:FilterDataTable.Filters>
                                                <ui:FilterDataTable.SelectColumns>
                                                  <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                    <x:Null />
                                                  </scg:List>
                                                </ui:FilterDataTable.SelectColumns>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:FilterDataTable>
                                            </Sequence>
                                          </ui:CommentOut.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:CommentOut>
                                        <ui:FilterDataTable sap2010:Annotation.AnnotationText="We filter the SF16 report data for the ILR and PR visa types." DataTable="[dtSF16Data]" DisplayName="Filter out ILR.PR data" FilterRowsMode="Remove" sap:VirtualizedContainerService.HintSize="314,103" sap2010:WorkflowViewState.IdRef="FilterDataTable_9" OutputDataTable="[dtNewLimitedLeave]" SelectColumnsMode="Keep">
                                          <ui:FilterDataTable.Filters>
                                            <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                              <ui:FilterOperationArgument BooleanOperator="And" Operator="CONTAINS">
                                                <ui:FilterOperationArgument.Column>
                                                  <InArgument x:TypeArguments="x:String">["Type (Label)"]</InArgument>
                                                </ui:FilterOperationArgument.Column>
                                                <ui:FilterOperationArgument.Operand>
                                                  <InArgument x:TypeArguments="x:String">["PR: Permanent Residency/Citizenship"]</InArgument>
                                                </ui:FilterOperationArgument.Operand>
                                              </ui:FilterOperationArgument>
                                              <ui:FilterOperationArgument BooleanOperator="Or" Operator="CONTAINS">
                                                <ui:FilterOperationArgument.Column>
                                                  <InArgument x:TypeArguments="x:String">["Type (Label)"]</InArgument>
                                                </ui:FilterOperationArgument.Column>
                                                <ui:FilterOperationArgument.Operand>
                                                  <InArgument x:TypeArguments="x:String">["ILR: Indefinite Leave to Remain"]</InArgument>
                                                </ui:FilterOperationArgument.Operand>
                                              </ui:FilterOperationArgument>
                                            </scg:List>
                                          </ui:FilterDataTable.Filters>
                                          <ui:FilterDataTable.SelectColumns>
                                            <scg:List x:TypeArguments="InArgument" Capacity="4">
                                              <x:Null />
                                            </scg:List>
                                          </ui:FilterDataTable.SelectColumns>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:FilterDataTable>
                                        <ui:ExcelWriteRange AddHeaders="True" DataTable="[dtNewLimitedLeave]" DisplayName="Update the Limited Leave sheet with the filtered data" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_18" SheetName="Limited Leave">
                                          <ui:ExcelWriteRange.StartingCell>
                                            <InArgument x:TypeArguments="x:String">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                          </ui:ExcelWriteRange.StartingCell>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExcelWriteRange>
                                        <ui:ExcelReadRange AddHeaders="True" DataTable="[dtNewLimitedLeave]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="314,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_11" SheetName="Limited Leave">
                                          <ui:ExcelReadRange.Range>
                                            <InArgument x:TypeArguments="x:String">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                          </ui:ExcelReadRange.Range>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExcelReadRange>
                                        <ui:ForEachRow CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="This is used to match the Employee Numbers in the new data against the old. This means that if there is a match over, we need to carry the comment from the old data into the new data." DataTable="[dtNewLimitedLeave]" DisplayName="Transfers Comments on Repeat Lines" sap:VirtualizedContainerService.HintSize="314,176" sap2010:WorkflowViewState.IdRef="ForEachRow_11">
                                          <ui:ForEachRow.Body>
                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="486,791" sap2010:WorkflowViewState.IdRef="Sequence_167">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="464,60" sap2010:WorkflowViewState.IdRef="Assign_142">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="sd:DataRow[]">[arrFilteredRows]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="sd:DataRow[]">[dtOldLimitedLeave.Select("[Employee Number] = '"+row(0).ToString+"'")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <If Condition="[arrFilteredRows.Length &gt; 0]" DisplayName="If Filtered table has more than 0 items" sap:VirtualizedContainerService.HintSize="464,567" sap2010:WorkflowViewState.IdRef="If_76">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <ui:ForEach x:TypeArguments="sd:DataRow" CurrentIndex="{x:Null}" DisplayName="For Each Item in Array" sap:VirtualizedContainerService.HintSize="286.5,418" sap2010:WorkflowViewState.IdRef="ForEach`1_1" Values="[arrFilteredRows]">
                                                      <ui:ForEach.Body>
                                                        <ActivityAction x:TypeArguments="sd:DataRow">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="sd:DataRow" Name="item" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="264,284" sap2010:WorkflowViewState.IdRef="Sequence_172">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_145">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Object">[row.Item("Further Comments")]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Object">[item(31).ToString+vbnewline+row("Further Comments").ToString]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_146">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Object">[row.Item("Date Email Sent")]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Object">[item(32).ToString]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:ForEach.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ForEach>
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ForEachRow.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ForEachRow>
                                        <ui:ForEachRow CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Opposite to the above, we need to make sure that we also carry over any lines that don't exist in the new report but have a comment. These will fall off as the comment is removed as it would not then be carried over to the new report." DataTable="[dtOLDLimitedLeave]" DisplayName="Transfer Comments that Don't Match Over" sap:VirtualizedContainerService.HintSize="314,208" sap2010:WorkflowViewState.IdRef="ForEachRow_12">
                                          <ui:ForEachRow.Body>
                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="611,656" sap2010:WorkflowViewState.IdRef="Sequence_171">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="589,60" sap2010:WorkflowViewState.IdRef="Assign_144">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="sd:DataRow[]">[arrFilteredRows]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="sd:DataRow[]">[dtNewLimitedLeave.Select("[Employee Number] = '"+row(0).ToString+"'")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <If Condition="[arrFilteredRows.Length &lt;= 0]" DisplayName="If array is empty" sap:VirtualizedContainerService.HintSize="589,432" sap2010:WorkflowViewState.IdRef="If_77">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <If Condition="[not string.IsNullOrEmpty(row(&quot;Further Comments&quot;).ToString)]" DisplayName="If Comments are not empty, then add to table" sap:VirtualizedContainerService.HintSize="464,283" sap2010:WorkflowViewState.IdRef="If_79">
                                                      <If.Then>
                                                        <InvokeMethod DisplayName="Invoke Method" sap:VirtualizedContainerService.HintSize="218.5,134" sap2010:WorkflowViewState.IdRef="InvokeMethod_2" MethodName="ImportRow">
                                                          <InvokeMethod.TargetObject>
                                                            <InArgument x:TypeArguments="sd:DataTable">[dtNewLimitedLeave]</InArgument>
                                                          </InvokeMethod.TargetObject>
                                                          <InArgument x:TypeArguments="sd:DataRow">[row]</InArgument>
                                                        </InvokeMethod>
                                                      </If.Then>
                                                    </If>
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ForEachRow.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ForEachRow>
                                        <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtNewLimitedLeave]" DisplayName="Check Limited Leave for 6 Month Sickness" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="ForEachRow_10">
                                          <ui:ForEachRow.Body>
                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="264,652" sap2010:WorkflowViewState.IdRef="Sequence_147">
                                                <Sequence.Variables>
                                                  <Variable x:TypeArguments="x:String" Name="strEmpName" />
                                                </Sequence.Variables>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_115">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                    </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_174">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[strEmpName]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[row(1).ToString.Replace("Mr","").Replace("Miss","").Replace("Dr","").Replace("Mrs","").Replace("Ms","")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="242,52" sap2010:WorkflowViewState.IdRef="CommentOut_61">
                                                  <ui:CommentOut.Body>
                                                    <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="633,176" sap2010:WorkflowViewState.IdRef="Sequence_210">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If Condition="[NOT string.IsNullOrWhitespace(row(27).ToString) AND string.IsNullOrWhiteSpace(row(28).ToString)]" DisplayName="If Sickness Start Date not Empty and End date is empty" sap:VirtualizedContainerService.HintSize="254.5,52" sap2010:WorkflowViewState.IdRef="If_62">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="Cell Not Empty" sap:VirtualizedContainerService.HintSize="486,657" sap2010:WorkflowViewState.IdRef="Sequence_146">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Assign sap:VirtualizedContainerService.HintSize="464,60" sap2010:WorkflowViewState.IdRef="Assign_116">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[strCurrentDate]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">[cdate(row(27).ToString).ToString("dd/MM/yyyy")]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <If Condition="[datetime.ParseExact(strCurrentDate,&quot;dd/MM/yyyy&quot;,system.Globalization.CultureInfo.InvariantCulture).AddMonths(6) &lt;= now]" DisplayName="If sickness longer than 6 months" sap:VirtualizedContainerService.HintSize="464,433" sap2010:WorkflowViewState.IdRef="If_61">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <Sequence DisplayName="Expiry within 3 months" sap:VirtualizedContainerService.HintSize="264,284" sap2010:WorkflowViewState.IdRef="Sequence_145">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_117">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:String">[strComment+vbnewline+"- Sickness longer than 6 months"]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_154">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Int32">[intCommentCount]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Int32">[intCommentCount+1]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                </Sequence>
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                    </Sequence>
                                                  </ui:CommentOut.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:CommentOut>
                                                <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="242,52" sap2010:WorkflowViewState.IdRef="CommentOut_41">
                                                  <ui:CommentOut.Body>
                                                    <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="486,176" sap2010:WorkflowViewState.IdRef="Sequence_152">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If Condition="[row(19).ToString.equals(&quot;T2: Tier 2 General&quot;) AND datetime.ParseExact(strCurrentDate,&quot;dd/MM/yyyy&quot;,system.Globalization.CultureInfo.InvariantCulture) &lt;=now.AddMonths(3) AND datetime.ParseExact(strCurrentDate,&quot;dd/MM/yyyy&quot;,system.Globalization.CultureInfo.InvariantCulture) &gt; now.adddays(-7)]" DisplayName="If Expiry Date within 3 months" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_67">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="Expiry within 3 months" sap:VirtualizedContainerService.HintSize="264,184" sap2010:WorkflowViewState.IdRef="Sequence_150">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_126">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">[strComment+vbnewline+"- LTR/Visa Expiry Date in 3 months or less"]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                    </Sequence>
                                                  </ui:CommentOut.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:CommentOut>
                                                <If Condition="[NOT string.IsNullOrWhitespace(row(25).ToString)]" DisplayName="If Visa Expiry Date not Empty" sap:VirtualizedContainerService.HintSize="242,52" sap2010:WorkflowViewState.IdRef="If_69">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Sequence DisplayName="Cell Not Empty" sap:VirtualizedContainerService.HintSize="264,368" sap2010:WorkflowViewState.IdRef="Sequence_154">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_127">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[strCurrentDate]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[cdate(row(25).ToString).ToString("dd/MM/yyyy")]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <If Condition="[row(19).ToString.equals(&quot;T2: Tier 2 General&quot;) AND datetime.ParseExact(strCurrentDate,&quot;dd/MM/yyyy&quot;,system.Globalization.CultureInfo.InvariantCulture) &lt;=now.AddMonths(3) AND datetime.ParseExact(strCurrentDate,&quot;dd/MM/yyyy&quot;,system.Globalization.CultureInfo.InvariantCulture) &gt; now.adddays(-7)]" DisplayName="If Expiry Date within 3 months - Tier 2 General" sap:VirtualizedContainerService.HintSize="242,52" sap2010:WorkflowViewState.IdRef="If_68">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="Expiry within 3 months" sap:VirtualizedContainerService.HintSize="264,376" sap2010:WorkflowViewState.IdRef="Sequence_153">
                                                            <Sequence.Variables>
                                                              <Variable x:TypeArguments="x:String" Name="strEmail2Template" />
                                                            </Sequence.Variables>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_128">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">[strComment+vbnewline+"- LTR/Visa Expiry Date in 3 months or less"]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_155">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Int32">[intCommentCount]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Int32">[intCommentCount+1]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <If Condition="[string.IsNullOrEmpty(row(&quot;Date Email Sent&quot;).ToString)]" DisplayName="If Email Completed Empty" sap:VirtualizedContainerService.HintSize="242,52" sap2010:WorkflowViewState.IdRef="If_80">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <Sequence sap:VirtualizedContainerService.HintSize="377,670" sap2010:WorkflowViewState.IdRef="Sequence_173">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:ReadTextFile Content="[strEmail2Template]" DisplayName="Read Text File" FileName="General Components\Input\Email Templates\Email 2.txt" sap:VirtualizedContainerService.HintSize="355,59" sap2010:WorkflowViewState.IdRef="ReadTextFile_2" />
                                                                  <Assign sap:VirtualizedContainerService.HintSize="355,60" sap2010:WorkflowViewState.IdRef="Assign_137">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:String">[strEmail2Template]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:String">[strEmail2Template.Replace("[EMPLOYEE NAME]",strEmpName).Replace("[VISA EXPIRY DATE]",cdate(row(25).ToString).ToString("dd/MM/yyyy"))]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <ui:SendOutlookMail Account="{x:Null}" Bcc="{x:Null}" MailMessage="{x:Null}" TimeoutMS="{x:Null}" Body="[strEmail2Template]" Cc="[row(30).ToString+&quot;;&quot;+strCCEmail]" DisplayName="Send Outlook Mail Message" sap:VirtualizedContainerService.HintSize="355,147" sap2010:WorkflowViewState.IdRef="SendOutlookMail_2" IsBodyHtml="True" IsDraft="False" Subject="ACTION REQUIRED: Tier 2 (General) visa extension application " To="[row(29).ToString]">
                                                                    <ui:SendOutlookMail.Files>
                                                                      <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                                                    </ui:SendOutlookMail.Files>
                                                                  </ui:SendOutlookMail>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="355,60" sap2010:WorkflowViewState.IdRef="Assign_140">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Object">[row.Item("Date Email Sent")]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Object">[now.ToString("dd/MM/yyyy")]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="355,60" sap2010:WorkflowViewState.IdRef="Assign_156">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Int32">[intEmailsSent]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Int32">[intEmailsSent+1]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                </Sequence>
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                      <If Condition="[NOT row(19).ToString.equals(&quot;T2: Tier 2 General&quot;) AND datetime.ParseExact(strCurrentDate,&quot;dd/MM/yyyy&quot;,system.Globalization.CultureInfo.InvariantCulture) &lt;=now.AddMonths(3) AND datetime.ParseExact(strCurrentDate,&quot;dd/MM/yyyy&quot;,system.Globalization.CultureInfo.InvariantCulture) &gt; now.adddays(-7)]" DisplayName="If Expiry Date within 3 months - Other Visas" sap:VirtualizedContainerService.HintSize="242,52" sap2010:WorkflowViewState.IdRef="If_74">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="Expiry within 3 months" sap:VirtualizedContainerService.HintSize="524,1144" sap2010:WorkflowViewState.IdRef="Sequence_165">
                                                            <Sequence.Variables>
                                                              <Variable x:TypeArguments="x:String" Name="strEmail2Template" />
                                                              <Variable x:TypeArguments="x:String" Name="strEmail3Template" />
                                                            </Sequence.Variables>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Assign sap:VirtualizedContainerService.HintSize="502,60" sap2010:WorkflowViewState.IdRef="Assign_138">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">[strComment+vbnewline+"- LTR/Visa Expiry Date in 3 months or less"]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <Assign sap:VirtualizedContainerService.HintSize="502,60" sap2010:WorkflowViewState.IdRef="Assign_157">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Int32">[intCommentCount]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Int32">[intCommentCount+1]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <If Condition="[string.IsNullOrEmpty(row(&quot;Date Email Sent&quot;).ToString)]" DisplayName="If Email Completed Empty" sap:VirtualizedContainerService.HintSize="502,820" sap2010:WorkflowViewState.IdRef="If_81">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <Sequence sap:VirtualizedContainerService.HintSize="377,670" sap2010:WorkflowViewState.IdRef="Sequence_174">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:ReadTextFile Content="[strEmail3Template]" DisplayName="Read Text File" FileName="General Components\Input\Email Templates\Email 3.txt" sap:VirtualizedContainerService.HintSize="355,59" sap2010:WorkflowViewState.IdRef="ReadTextFile_3" />
                                                                  <Assign sap:VirtualizedContainerService.HintSize="355,60" sap2010:WorkflowViewState.IdRef="Assign_139">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:String">[strEmail3Template]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:String">[strEmail3Template.Replace("[EMPLOYEE NAME]",strEmpName).Replace("[VISA EXPIRY DATE]",cdate(row(25).ToString).ToString("dd/MM/yyyy")).Replace("[TYPE LABEL]",row(19).ToString)]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <ui:SendOutlookMail Account="{x:Null}" Bcc="{x:Null}" MailMessage="{x:Null}" TimeoutMS="{x:Null}" Body="[strEmail3Template]" Cc="[row(30).ToString+&quot;;&quot;+strCCEmail]" DisplayName="Send Outlook Mail Message" sap:VirtualizedContainerService.HintSize="355,147" sap2010:WorkflowViewState.IdRef="SendOutlookMail_3" IsBodyHtml="True" IsDraft="False" Subject="ACTION REQUIRED: Limited Leave expiring visa" To="[row(29).ToString]">
                                                                    <ui:SendOutlookMail.Files>
                                                                      <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                                                    </ui:SendOutlookMail.Files>
                                                                  </ui:SendOutlookMail>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="355,60" sap2010:WorkflowViewState.IdRef="Assign_141">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Object">[row.Item("Date Email Sent")]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Object">[now.ToString("dd/MM/yyyy")]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="355,60" sap2010:WorkflowViewState.IdRef="Assign_158">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Int32">[intEmailsSent]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Int32">[intEmailsSent+1]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                </Sequence>
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                    </Sequence>
                                                  </If.Then>
                                                </If>
                                                <If Condition="[NOT string.IsNullOrEmpty(strComment)]" DisplayName="If Comment is not Empty" sap:VirtualizedContainerService.HintSize="242,52" sap2010:WorkflowViewState.IdRef="If_66">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="264,276" sap2010:WorkflowViewState.IdRef="Sequence_149">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_125">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">["Robot Comment "+now.ToString("dd MM yy")+":"+strComment]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <If Condition="[string.IsNullOrWhiteSpace(row(&quot;Further Comments&quot;).ToString)]" DisplayName="If Comment Field is Empty, just write coment, otherwise add to current comment" sap:VirtualizedContainerService.HintSize="242,52" sap2010:WorkflowViewState.IdRef="If_65">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_123">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:Object">[row.Item("Further Comments")]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:Object">[strComment]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </If.Then>
                                                        <If.Else>
                                                          <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_124">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:Object">[row.Item("Further Comments")]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[row.Item("Further Comments").ToString+vbnewline+vbnewline+strComment]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </If.Else>
                                                      </If>
                                                    </Sequence>
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ForEachRow.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ForEachRow>
                                        <ui:SortDataTable ColumnName="{x:Null}" DataColumn="{x:Null}" ColumnIndex="[30]" DataTable="[dtNewLimitedLeave]" DisplayName="Sort Data Table" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="SortDataTable_3" Order="Decending" OutputDataTable="[dtNewLimitedLeave]" />
                                        <ui:ExcelWriteRange AddHeaders="False" DataTable="[dtNewLimitedLeave]" DisplayName="Update the Limited Leave sheet with the filtered data" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_19" SheetName="Limited Leave" StartingCell="A2">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExcelWriteRange>
                                        <Delay Duration="00:00:02" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="Delay_5" />
                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="LogMessage_29" Level="Info" Message="[&quot;Limited Leave Item Count: &quot;+dtNewLimitedLeave.Rows.Count.ToString]">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:LogMessage>
                                        <Sequence sap2010:Annotation.AnnotationText="We have to take this approach to deleting empty lines as to preserve the coloured cells." DisplayName="Remove Duplicates" sap:VirtualizedContainerService.HintSize="314,128" sap2010:WorkflowViewState.IdRef="Sequence_189">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Assign sap:VirtualizedContainerService.HintSize="512,60" sap2010:WorkflowViewState.IdRef="Assign_166">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Int32">[intIndex]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Int32">[dtNewLimitedLeave.Rows.Count-1]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <While DisplayName="While Rows Exist" sap:VirtualizedContainerService.HintSize="512,770" sap2010:WorkflowViewState.IdRef="While_5">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <While.Condition>[intIndex &gt;= 0]</While.Condition>
                                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="486,611" sap2010:WorkflowViewState.IdRef="Sequence_188">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If Condition="[cdate(dtNewLimitedLeave.Rows(intIndex).Item(&quot;LTR/Visa Expiry Date&quot;).ToString)&lt;now AND string.IsNullOrWhiteSpace(dtNewLimitedLeave.Rows(intIndex).Item(&quot;Further Comments&quot;).ToString)]" DisplayName="If Further Comments are empty, then delete the row" sap:VirtualizedContainerService.HintSize="464,387" sap2010:WorkflowViewState.IdRef="If_85">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If.Then>
                                                  <Sequence sap:VirtualizedContainerService.HintSize="222,238" sap2010:WorkflowViewState.IdRef="Sequence_187">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="CommentOut_58">
                                                      <ui:CommentOut.Body>
                                                        <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="222,146" sap2010:WorkflowViewState.IdRef="Sequence_207">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:ExcelSetRangeColor Color="[system.Drawing.Color.Yellow]" DisplayName="Set Range Color" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="ExcelSetRangeColor_16" Range="[&quot;A&quot;+(intindex+2).ToString+&quot;:AJ&quot;+(intindex+2).ToString]" SheetName="Limited Leave" />
                                                        </Sequence>
                                                      </ui:CommentOut.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:CommentOut>
                                                    <ui:ExcelInsertDeleteRows DisplayName="Insert/Delete Rows" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="ExcelInsertDeleteRows_7" Mode="Remove" NoRows="1" Position="[intIndex+2]" SheetName="Limited Leave" />
                                                  </Sequence>
                                                </If.Then>
                                              </If>
                                              <Assign sap:VirtualizedContainerService.HintSize="464,60" sap2010:WorkflowViewState.IdRef="Assign_167">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Int32">[intIndex]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Int32">[intIndex-1]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                            </Sequence>
                                          </While>
                                        </Sequence>
                                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="CommentOut_47">
                                          <ui:CommentOut.Body>
                                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="556,1014" sap2010:WorkflowViewState.IdRef="Sequence_183">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Sequence sap2010:Annotation.AnnotationText="We have to take this approach to deleting empty lines as to preserve the coloured cells." DisplayName="Remove Empty Lines" sap:VirtualizedContainerService.HintSize="534,890" sap2010:WorkflowViewState.IdRef="Sequence_157">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="512,60" sap2010:WorkflowViewState.IdRef="Assign_129">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:Int32">[intIndex]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:Int32">[dtNewLimitedLeave.Rows.Count-1]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <While DisplayName="While Rows Exist" sap:VirtualizedContainerService.HintSize="512,678" sap2010:WorkflowViewState.IdRef="While_4">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <While.Condition>[intIndex &gt;= 0]</While.Condition>
                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="486,519" sap2010:WorkflowViewState.IdRef="Sequence_156">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If Condition="[string.IsNullOrWhiteSpace(dtNewLimitedLeave.Rows(intIndex).Item(&quot;Further Comments&quot;).ToString)]" DisplayName="If Further Comments are empty, then delete the row" sap:VirtualizedContainerService.HintSize="464,295" sap2010:WorkflowViewState.IdRef="If_70">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If.Then>
                                                        <Sequence sap:VirtualizedContainerService.HintSize="222,146" sap2010:WorkflowViewState.IdRef="Sequence_155">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:ExcelInsertDeleteRows DisplayName="Insert/Delete Rows" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="ExcelInsertDeleteRows_5" Mode="Remove" NoRows="1" Position="[intIndex+2]" SheetName="Limited Leave" />
                                                        </Sequence>
                                                      </If.Then>
                                                    </If>
                                                    <Assign sap:VirtualizedContainerService.HintSize="464,60" sap2010:WorkflowViewState.IdRef="Assign_130">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:Int32">[intIndex]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:Int32">[intIndex-1]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                  </Sequence>
                                                </While>
                                              </Sequence>
                                            </Sequence>
                                          </ui:CommentOut.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:CommentOut>
                                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="CommentOut_35">
                                          <ui:CommentOut.Body>
                                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="538,395" sap2010:WorkflowViewState.IdRef="Sequence_140">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:ExcelReadRange AddHeaders="True" DataTable="[dtNewLimitedLeave]" DisplayName="Read the Limitied Leave sheet with the updated headers" sap:VirtualizedContainerService.HintSize="516,52" sap2010:WorkflowViewState.IdRef="ExcelReadRange_6" Range="A1" SheetName="Limited Leave">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ExcelReadRange>
                                              <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtNewLimitedLeave]" DisplayName="Check Limited Leave for Changes" sap:VirtualizedContainerService.HintSize="516,52" sap2010:WorkflowViewState.IdRef="ForEachRow_6">
                                                <ui:ForEachRow.Body>
                                                  <ActivityAction x:TypeArguments="sd:DataRow">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="486,841" sap2010:WorkflowViewState.IdRef="Sequence_94">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="464,60" sap2010:WorkflowViewState.IdRef="Assign_56">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">
                                                            <Literal x:TypeArguments="x:String" Value="" />
                                                          </InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Assign sap:VirtualizedContainerService.HintSize="464,60" sap2010:WorkflowViewState.IdRef="Assign_75">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[strRowIndex]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[(dtNewLimitedLeave.Rows.IndexOf(row)+2).ToString]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <If Condition="[NOT string.IsNullOrWhitespace(row(27).ToString)]" DisplayName="Check Sickness Length" sap:VirtualizedContainerService.HintSize="464,425" sap2010:WorkflowViewState.IdRef="If_40">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="Cells not empty" sap:VirtualizedContainerService.HintSize="264,276" sap2010:WorkflowViewState.IdRef="Sequence_100">
                                                            <Sequence.Variables>
                                                              <Variable x:TypeArguments="x:String" Name="strStartDate" />
                                                            </Sequence.Variables>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_76">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[strStartDate]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">[cdate(row(27).ToString).ToString("dd/MM/yyyy")]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <If Condition="[datetime.ParseExact(strStartDate,&quot;dd/MM/yyyy&quot;,system.Globalization.CultureInfo.InvariantCulture).AddMonths(1) &lt;= now]" DisplayName="If Sickness is more than 1 month" sap:VirtualizedContainerService.HintSize="242,52" sap2010:WorkflowViewState.IdRef="If_39">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <Sequence DisplayName="Sick Longer Than Month" sap:VirtualizedContainerService.HintSize="264,246" sap2010:WorkflowViewState.IdRef="Sequence_99">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_77">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:String">[strComment+vbnewline+"- Sickness longer than 1 month"]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <ui:ExcelSetRangeColor Color="[system.Drawing.Color.Red]" DisplayName="Set Range Color" sap:VirtualizedContainerService.HintSize="242,22" sap2010:WorkflowViewState.IdRef="ExcelSetRangeColor_7" Range="[&quot;A&quot;+strRowIndex+&quot;:AG&quot;+strRowIndex]" SheetName="Limited Leave" />
                                                                </Sequence>
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                      <If Condition="[NOT string.IsNullOrWhiteSpace(strComment)]" DisplayName="If Comments have been added" sap:VirtualizedContainerService.HintSize="464,52" sap2010:WorkflowViewState.IdRef="If_38">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="Comments Exist" sap:VirtualizedContainerService.HintSize="264,276" sap2010:WorkflowViewState.IdRef="Sequence_93">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_72">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">["Robot Comment "+now.ToString("dd MM yy")+":"+strComment]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <If Condition="[string.IsNullOrWhiteSpace(row(&quot;Further Comments&quot;).ToString)]" DisplayName="If Comment Field is Empty, just write coment, otherwise add to current comment" sap:VirtualizedContainerService.HintSize="242,52" sap2010:WorkflowViewState.IdRef="If_37">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_73">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Object">[row.Item("Further Comments")]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:Object">[strComment]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </If.Then>
                                                              <If.Else>
                                                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_74">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Object">[row.Item("Further Comments")]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">[row.Item("Further Comments").ToString+vbnewline+vbnewline+strComment]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </If.Else>
                                                            </If>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:ForEachRow.Body>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ForEachRow>
                                              <ui:ExcelWriteRange AddHeaders="True" DataTable="[dtNewLimitedLeave]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="516,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_8" SheetName="Limited Leave" StartingCell="A1" />
                                            </Sequence>
                                          </ui:CommentOut.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:CommentOut>
                                      </Sequence>
                                      <Sequence DisplayName="Create Changes Check Sheet" sap:VirtualizedContainerService.HintSize="845,5543" sap2010:WorkflowViewState.IdRef="Sequence_115">
                                        <Sequence.Variables>
                                          <Variable x:TypeArguments="sd:DataTable" Name="dtChangesCheck" />
                                          <Variable x:TypeArguments="sd:DataTable" Name="dtFurtherComments" />
                                        </Sequence.Variables>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="823,52" sap2010:WorkflowViewState.IdRef="LogMessage_35" Level="Info" Message="[&quot;Creating Changes Check sheet&quot;]">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:LogMessage>
                                        <ui:FilterDataTable DataTable="[dtSF16Data]" DisplayName="Filter Data Table for Tier 2 Visas" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="823,59" sap2010:WorkflowViewState.IdRef="FilterDataTable_4" OutputDataTable="[dtChangesCheck]" SelectColumnsMode="Keep">
                                          <ui:FilterDataTable.Filters>
                                            <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                              <ui:FilterOperationArgument BooleanOperator="And" Operator="CONTAINS">
                                                <ui:FilterOperationArgument.Column>
                                                  <InArgument x:TypeArguments="x:String">["Type (Label)"]</InArgument>
                                                </ui:FilterOperationArgument.Column>
                                                <ui:FilterOperationArgument.Operand>
                                                  <InArgument x:TypeArguments="x:String">["T2: Tier 2 General"]</InArgument>
                                                </ui:FilterOperationArgument.Operand>
                                              </ui:FilterOperationArgument>
                                              <ui:FilterOperationArgument BooleanOperator="Or" Operator="CONTAINS">
                                                <ui:FilterOperationArgument.Column>
                                                  <InArgument x:TypeArguments="x:String">["Type (Label)"]</InArgument>
                                                </ui:FilterOperationArgument.Column>
                                                <ui:FilterOperationArgument.Operand>
                                                  <InArgument x:TypeArguments="x:String" xml:space="preserve">["T2: Tier  2 General Extension"]</InArgument>
                                                </ui:FilterOperationArgument.Operand>
                                              </ui:FilterOperationArgument>
                                              <ui:FilterOperationArgument BooleanOperator="Or" Operator="CONTAINS">
                                                <ui:FilterOperationArgument.Column>
                                                  <InArgument x:TypeArguments="x:String">["Type (Label)"]</InArgument>
                                                </ui:FilterOperationArgument.Column>
                                                <ui:FilterOperationArgument.Operand>
                                                  <InArgument x:TypeArguments="x:String">["T2: Tier 2 Spouse"]</InArgument>
                                                </ui:FilterOperationArgument.Operand>
                                              </ui:FilterOperationArgument>
                                              <ui:FilterOperationArgument BooleanOperator="Or" Operator="CONTAINS">
                                                <ui:FilterOperationArgument.Column>
                                                  <InArgument x:TypeArguments="x:String">["Type (Label)"]</InArgument>
                                                </ui:FilterOperationArgument.Column>
                                                <ui:FilterOperationArgument.Operand>
                                                  <InArgument x:TypeArguments="x:String">["T2: Tier 2 (Dependant)"]</InArgument>
                                                </ui:FilterOperationArgument.Operand>
                                              </ui:FilterOperationArgument>
                                            </scg:List>
                                          </ui:FilterDataTable.Filters>
                                          <ui:FilterDataTable.SelectColumns>
                                            <scg:List x:TypeArguments="InArgument" Capacity="4">
                                              <x:Null />
                                            </scg:List>
                                          </ui:FilterDataTable.SelectColumns>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:FilterDataTable>
                                        <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtChangesCheck]" DisplayName="Check Changes" sap:VirtualizedContainerService.HintSize="823,4069" sap2010:WorkflowViewState.IdRef="ForEachRow_8">
                                          <ui:ForEachRow.Body>
                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="793,3921" sap2010:WorkflowViewState.IdRef="Sequence_117">
                                                <Sequence.Variables>
                                                  <Variable x:TypeArguments="ui:GenericValue" Name="strEmpName" />
                                                </Sequence.Variables>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="771,60" sap2010:WorkflowViewState.IdRef="Assign_93">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                    </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="771,60" sap2010:WorkflowViewState.IdRef="Assign_175">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="ui:GenericValue">[strEmpName]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="ui:GenericValue">[row(1).ToString.Replace("Mr","").Replace("Miss","").Replace("Dr","").Replace("Mrs","").Replace("Ms","")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="771,60" sap2010:WorkflowViewState.IdRef="Assign_94">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[strRowIndex]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[(dtChangesCheck.Rows.IndexOf(row)+2).ToString]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="771,60" sap2010:WorkflowViewState.IdRef="Assign_95">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="sd:DataRow[]">[arrFilteredRows]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="sd:DataRow[]">[Nothing]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="771,60" sap2010:WorkflowViewState.IdRef="Assign_96">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="sd:DataRow[]">[arrFilteredRows]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="sd:DataRow[]">[dtOLDSF16.Select("[Employee Number] = '"+row(0).ToString+"'")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <If Condition="[arrFilteredRows.Length&gt;0]" DisplayName="If Filtered Table has data" sap:VirtualizedContainerService.HintSize="771,1592" sap2010:WorkflowViewState.IdRef="If_50">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Sequence DisplayName="Table Has Data" sap:VirtualizedContainerService.HintSize="538,1443" sap2010:WorkflowViewState.IdRef="Sequence_112">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="516,60" sap2010:WorkflowViewState.IdRef="Assign_78">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="sd:DataTable">[dtOLDSF16Filtered]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="sd:DataTable">[arrFilteredRows.CopyToDataTable]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtOLDSF16Filtered]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="516,1219" sap2010:WorkflowViewState.IdRef="ForEachRow_7">
                                                        <ui:ForEachRow.Body>
                                                          <ActivityAction x:TypeArguments="sd:DataRow">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="sd:DataRow" Name="line" />
                                                            </ActivityAction.Argument>
                                                            <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="486,1071" sap2010:WorkflowViewState.IdRef="Sequence_111">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If Condition="[NOT row(4).ToString.Contains(line(4).ToString)]" DisplayName="If Unit has changes" sap:VirtualizedContainerService.HintSize="464,52" sap2010:WorkflowViewState.IdRef="If_41">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <Sequence DisplayName="Unit Changes" sap:VirtualizedContainerService.HintSize="264,246" sap2010:WorkflowViewState.IdRef="Sequence_101">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_79">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[strComment+vbnewline+"- Unit has Changed from "+line(4).ToString]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <ui:ExcelSetRangeColor Color="[system.Drawing.Color.Yellow]" DisplayName="Set Range Color" sap:VirtualizedContainerService.HintSize="242,22" sap2010:WorkflowViewState.IdRef="ExcelSetRangeColor_8" Range="[&quot;E&quot;+strRowIndex]" SheetName="Changes Check" />
                                                                  </Sequence>
                                                                </If.Then>
                                                              </If>
                                                              <If Condition="[NOT row(7).ToString.Contains(line(7).ToString)]" DisplayName="If Position Title has changes" sap:VirtualizedContainerService.HintSize="464,52" sap2010:WorkflowViewState.IdRef="If_42">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <Sequence DisplayName="Position Title Changes" sap:VirtualizedContainerService.HintSize="264,246" sap2010:WorkflowViewState.IdRef="Sequence_102">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_80">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[strComment+vbnewline+"- Position Title has changed from "+line(7).ToString]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <ui:ExcelSetRangeColor Color="[system.Drawing.Color.Yellow]" DisplayName="Set Range Color" sap:VirtualizedContainerService.HintSize="242,22" sap2010:WorkflowViewState.IdRef="ExcelSetRangeColor_9" Range="[&quot;H&quot;+strRowIndex]" SheetName="Changes Check" />
                                                                  </Sequence>
                                                                </If.Then>
                                                              </If>
                                                              <If Condition="[NOT row(9).ToString.Contains(line(9).ToString)]" DisplayName="If Contractual Location has changes" sap:VirtualizedContainerService.HintSize="464,52" sap2010:WorkflowViewState.IdRef="If_43">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <Sequence DisplayName="Contractual Location Changes" sap:VirtualizedContainerService.HintSize="264,246" sap2010:WorkflowViewState.IdRef="Sequence_103">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_81">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[strComment+vbnewline+"- Contractual Location has changed from "+line(9).ToString]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <ui:ExcelSetRangeColor Color="[system.Drawing.Color.Yellow]" DisplayName="Set Range Color" sap:VirtualizedContainerService.HintSize="242,22" sap2010:WorkflowViewState.IdRef="ExcelSetRangeColor_10" Range="[&quot;J&quot;+strRowIndex]" SheetName="Changes Check" />
                                                                  </Sequence>
                                                                </If.Then>
                                                              </If>
                                                              <If Condition="[NOT row(10).ToString.Contains(line(10).ToString)]" DisplayName="If Designated Location has changes" sap:VirtualizedContainerService.HintSize="464,52" sap2010:WorkflowViewState.IdRef="If_44">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <Sequence DisplayName="Designated Location Changes" sap:VirtualizedContainerService.HintSize="264,246" sap2010:WorkflowViewState.IdRef="Sequence_104">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_82">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[strComment+vbnewline+"-Designated Location has changed from "+line(10).ToString]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <ui:ExcelSetRangeColor Color="[system.Drawing.Color.Yellow]" DisplayName="Set Range Color" sap:VirtualizedContainerService.HintSize="242,22" sap2010:WorkflowViewState.IdRef="ExcelSetRangeColor_11" Range="[&quot;K&quot;+strRowIndex]" SheetName="Changes Check" />
                                                                  </Sequence>
                                                                </If.Then>
                                                              </If>
                                                              <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="464,52" sap2010:WorkflowViewState.IdRef="CommentOut_43">
                                                                <ui:CommentOut.Body>
                                                                  <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="486,176" sap2010:WorkflowViewState.IdRef="Sequence_166">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <If Condition="[NOT row(19).ToString.Contains(line(19).ToString)]" DisplayName="If Type has changes" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_45">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <If.Then>
                                                                        <Sequence DisplayName="Type Changes" sap:VirtualizedContainerService.HintSize="264,246" sap2010:WorkflowViewState.IdRef="Sequence_105">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_83">
                                                                            <Assign.To>
                                                                              <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                                            </Assign.To>
                                                                            <Assign.Value>
                                                                              <InArgument x:TypeArguments="x:String">[strComment+vbnewline+"- Type (Label) has changed from "+line(19).ToString]</InArgument>
                                                                            </Assign.Value>
                                                                          </Assign>
                                                                          <ui:ExcelSetRangeColor Color="[system.Drawing.Color.Yellow]" DisplayName="Set Range Color" sap:VirtualizedContainerService.HintSize="242,22" sap2010:WorkflowViewState.IdRef="ExcelSetRangeColor_12" Range="[&quot;T&quot;+strRowIndex]" SheetName="Changes Check" />
                                                                        </Sequence>
                                                                      </If.Then>
                                                                    </If>
                                                                  </Sequence>
                                                                </ui:CommentOut.Body>
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                              </ui:CommentOut>
                                                              <If Condition="[NOT row(27).ToString.Contains(line(27).ToString)]" DisplayName="If Contractual Working Hours has changes" sap:VirtualizedContainerService.HintSize="464,52" sap2010:WorkflowViewState.IdRef="If_46">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <Sequence DisplayName="Contractual Hours Changes" sap:VirtualizedContainerService.HintSize="264,246" sap2010:WorkflowViewState.IdRef="Sequence_106">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_84">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[strComment+vbnewline+"- Contractual Hours have changed from "+ line(27).ToString]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <ui:ExcelSetRangeColor Color="[system.Drawing.Color.Yellow]" DisplayName="Set Range Color" sap:VirtualizedContainerService.HintSize="242,22" sap2010:WorkflowViewState.IdRef="ExcelSetRangeColor_14" Range="[&quot;AE&quot;+strRowIndex]" SheetName="Changes Check" />
                                                                  </Sequence>
                                                                </If.Then>
                                                              </If>
                                                              <If Condition="[cint(row(28).ToString) &lt; cint(line(28).ToString)]" DisplayName="If Salary Amount has changes" sap:VirtualizedContainerService.HintSize="464,395" sap2010:WorkflowViewState.IdRef="If_47">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <Sequence DisplayName="Salary Amount Changes" sap:VirtualizedContainerService.HintSize="264,246" sap2010:WorkflowViewState.IdRef="Sequence_107">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_85">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[strComment+vbnewline+"- Salary Amount has changed from "+line(28).ToString]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <ui:ExcelSetRangeColor Color="[system.Drawing.Color.Yellow]" DisplayName="Set Range Color" sap:VirtualizedContainerService.HintSize="242,22" sap2010:WorkflowViewState.IdRef="ExcelSetRangeColor_15" Range="[&quot;AF&quot;+strRowIndex]" SheetName="Changes Check" />
                                                                  </Sequence>
                                                                </If.Then>
                                                              </If>
                                                            </Sequence>
                                                          </ActivityAction>
                                                        </ui:ForEachRow.Body>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:ForEachRow>
                                                    </Sequence>
                                                  </If.Then>
                                                  <If.Else>
                                                    <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="CommentOut_26">
                                                      <ui:CommentOut.Body>
                                                        <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="358,403" sap2010:WorkflowViewState.IdRef="Sequence_126">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Sequence sap:VirtualizedContainerService.HintSize="336,279" sap2010:WorkflowViewState.IdRef="Sequence_124">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:ExcelInsertDeleteRows DisplayName="Insert/Delete Rows" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="ExcelInsertDeleteRows_2" Mode="Remove" NoRows="1" Position="[(dtChangesCheck.Rows.IndexOf(row)+2)]" SheetName="Changes Check" />
                                                            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_36" Level="Info" Message="[&quot;Removing row 2.&quot;]" />
                                                          </Sequence>
                                                        </Sequence>
                                                      </ui:CommentOut.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:CommentOut>
                                                  </If.Else>
                                                </If>
                                                <If Condition="[NOT string.IsNullOrWhiteSpace(strComment)]" DisplayName="If Comments have been added" sap:VirtualizedContainerService.HintSize="771,1665" sap2010:WorkflowViewState.IdRef="If_72">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Sequence DisplayName="Comments Exist" sap:VirtualizedContainerService.HintSize="546,1516" sap2010:WorkflowViewState.IdRef="Sequence_158">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="524,60" sap2010:WorkflowViewState.IdRef="Assign_131">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">["Robot Comment "+now.ToString("dd MM yy")+":"+vbnewline+strComment.Trim]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <If Condition="[string.IsNullOrWhiteSpace(row(&quot;Further Comments&quot;).ToString)]" DisplayName="If Comment Field is Empty, just write coment, otherwise add to current comment" sap:VirtualizedContainerService.HintSize="524,209" sap2010:WorkflowViewState.IdRef="If_71">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_132">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:Object">[row.Item("Further Comments")]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:Object">[strComment]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </If.Then>
                                                        <If.Else>
                                                          <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_133">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:Object">[row.Item("Further Comments")]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[row.Item("Further Comments").ToString+vbnewline+vbnewline+strComment]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </If.Else>
                                                      </If>
                                                      <Sequence DisplayName="Send Limited Leave Email" sap:VirtualizedContainerService.HintSize="524,1043" sap2010:WorkflowViewState.IdRef="Sequence_163">
                                                        <Sequence.Variables>
                                                          <Variable x:TypeArguments="x:String" Name="strEmail1Template" />
                                                        </Sequence.Variables>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If Condition="[row(19).ToString.Equals(&quot;T2: Tier 2 General&quot;)]" sap:VirtualizedContainerService.HintSize="502,919" sap2010:WorkflowViewState.IdRef="If_73">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <Sequence sap:VirtualizedContainerService.HintSize="377,770" sap2010:WorkflowViewState.IdRef="Sequence_162">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <Assign sap:VirtualizedContainerService.HintSize="355,60" sap2010:WorkflowViewState.IdRef="Assign_135">
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="x:String">[strComment]</OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="x:String">[strComment.Replace("Robot Comment "+now.ToString("dd MM yy")+":","").Trim.Replace("-","&lt;br&gt;"+"-").Trim]</InArgument>
                                                                </Assign.Value>
                                                              </Assign>
                                                              <Assign sap:VirtualizedContainerService.HintSize="355,60" sap2010:WorkflowViewState.IdRef="Assign_159">
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="x:Int32">[intCommentCount]</OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="x:Int32">[intCommentCount+1]</InArgument>
                                                                </Assign.Value>
                                                              </Assign>
                                                              <ui:ReadTextFile Content="[strEmail1Template]" DisplayName="Read Text File" FileName="General Components\Input\Email Templates\Email 1.txt" sap:VirtualizedContainerService.HintSize="355,59" sap2010:WorkflowViewState.IdRef="ReadTextFile_1" />
                                                              <Assign sap:VirtualizedContainerService.HintSize="355,60" sap2010:WorkflowViewState.IdRef="Assign_136">
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="x:String">[strEmail1Template]</OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="x:String">[strEmail1Template.Replace("[LINE MANAGER NAME]",row(3).ToString).Replace("[EMPLOYEE NAME]",strEmpName).Replace("[EMPLOYEE NUMBER]",row(0).ToString).Replace("[CHANGE FIELDS]",strComment)]</InArgument>
                                                                </Assign.Value>
                                                              </Assign>
                                                              <ui:SendOutlookMail Account="{x:Null}" Bcc="{x:Null}" MailMessage="{x:Null}" TimeoutMS="{x:Null}" Body="[strEmail1Template]" Cc="[row(30).ToString+&quot;;&quot;+strCCEmail]" DisplayName="Send Outlook Mail Message" sap:VirtualizedContainerService.HintSize="355,147" sap2010:WorkflowViewState.IdRef="SendOutlookMail_1" IsBodyHtml="True" IsDraft="False" Subject="ACTION REQUIRED: TIER 2 (General) Sponsored Employee Change to role" To="[row(30).ToString]">
                                                                <ui:SendOutlookMail.Files>
                                                                  <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                                                </ui:SendOutlookMail.Files>
                                                              </ui:SendOutlookMail>
                                                              <Assign sap:VirtualizedContainerService.HintSize="355,60" sap2010:WorkflowViewState.IdRef="Assign_160">
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="x:Int32">[intEmailsSent]</OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="x:Int32">[intEmailsSent+1]</InArgument>
                                                                </Assign.Value>
                                                              </Assign>
                                                            </Sequence>
                                                          </If.Then>
                                                        </If>
                                                      </Sequence>
                                                    </Sequence>
                                                  </If.Then>
                                                  <If.Else>
                                                    <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="CommentOut_42">
                                                      <ui:CommentOut.Body>
                                                        <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="358,403" sap2010:WorkflowViewState.IdRef="Sequence_160">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Sequence sap:VirtualizedContainerService.HintSize="336,279" sap2010:WorkflowViewState.IdRef="Sequence_159">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:ExcelInsertDeleteRows DisplayName="Insert/Delete Rows" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="ExcelInsertDeleteRows_6" Mode="Remove" NoRows="1" Position="[(dtChangesCheck.Rows.IndexOf(row)+2)]" SheetName="Changes Check" />
                                                            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_39" Level="Info" Message="[&quot;Removing row.&quot;]" />
                                                          </Sequence>
                                                        </Sequence>
                                                      </ui:CommentOut.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:CommentOut>
                                                  </If.Else>
                                                </If>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ForEachRow.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ForEachRow>
                                        <ui:ExcelWriteRange AddHeaders="True" DataTable="[dtChangesCheck]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="823,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_17" SheetName="Changes Check" StartingCell="A1">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExcelWriteRange>
                                        <Delay Duration="00:00:02" sap:VirtualizedContainerService.HintSize="823,22" sap2010:WorkflowViewState.IdRef="Delay_6" />
                                        <Sequence sap2010:Annotation.AnnotationText="We have to take this approach to deleting empty lines as to preserve the coloured cells." DisplayName="Remove Empty Lines" sap:VirtualizedContainerService.HintSize="823,930" sap2010:WorkflowViewState.IdRef="Sequence_132">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Assign sap:VirtualizedContainerService.HintSize="512,60" sap2010:WorkflowViewState.IdRef="Assign_108">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Int32">[intIndex]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Int32">[dtChangesCheck.Rows.Count-1]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <While DisplayName="While Rows Exist" sap:VirtualizedContainerService.HintSize="512,678" sap2010:WorkflowViewState.IdRef="While_3">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <While.Condition>[intIndex &gt;= 0]</While.Condition>
                                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="486,519" sap2010:WorkflowViewState.IdRef="Sequence_131">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If Condition="[string.IsNullOrWhiteSpace(dtChangesCheck.Rows(intIndex).Item(&quot;Further Comments&quot;).ToString)]" DisplayName="If Further Comments are empty, then delete the row" sap:VirtualizedContainerService.HintSize="464,295" sap2010:WorkflowViewState.IdRef="If_59">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If.Then>
                                                  <Sequence sap:VirtualizedContainerService.HintSize="222,146" sap2010:WorkflowViewState.IdRef="Sequence_130">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:ExcelInsertDeleteRows DisplayName="Insert/Delete Rows" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="ExcelInsertDeleteRows_4" Mode="Remove" NoRows="1" Position="[intIndex+2]" SheetName="Changes Check" />
                                                  </Sequence>
                                                </If.Then>
                                              </If>
                                              <Assign sap:VirtualizedContainerService.HintSize="464,60" sap2010:WorkflowViewState.IdRef="Assign_109">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Int32">[intIndex]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Int32">[intIndex-1]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                            </Sequence>
                                          </While>
                                        </Sequence>
                                      </Sequence>
                                      <Sequence DisplayName="Create Leavers Sheet" sap:VirtualizedContainerService.HintSize="845,52" sap2010:WorkflowViewState.IdRef="Sequence_120">
                                        <Sequence.Variables>
                                          <Variable x:TypeArguments="sd:DataTable" Name="dtLeavers" />
                                        </Sequence.Variables>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:BuildDataTable DataTable="[dtLeavers]" DisplayName="Build Data Table" sap:VirtualizedContainerService.HintSize="663,59" sap2010:WorkflowViewState.IdRef="BuildDataTable_1" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;Employee_x0020_Number&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Name&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Employment_x0020_Status&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
                                        <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtOLDSF16]" DisplayName="Check Changes" sap:VirtualizedContainerService.HintSize="663,954" sap2010:WorkflowViewState.IdRef="ForEachRow_9">
                                          <ui:ForEachRow.Body>
                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="633,806" sap2010:WorkflowViewState.IdRef="Sequence_119">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="611,60" sap2010:WorkflowViewState.IdRef="Assign_104">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="sd:DataRow[]">[arrFilteredRows]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="sd:DataRow[]">[Nothing]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="611,60" sap2010:WorkflowViewState.IdRef="Assign_105">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="sd:DataRow[]">[arrFilteredRows]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="sd:DataRow[]">[dtSF16Data.Select("[Employee Number] = '"+row(0).ToString+"'")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <If Condition="[arrFilteredRows.Length&gt;0]" DisplayName="If Filtered Table has no data" sap:VirtualizedContainerService.HintSize="611,482" sap2010:WorkflowViewState.IdRef="If_56">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Else>
                                                    <Sequence DisplayName="Table Has no Data" sap:VirtualizedContainerService.HintSize="486,333" sap2010:WorkflowViewState.IdRef="Sequence_118">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If Condition="[row(19).ToString.Equals(&quot;T2: Tier  2 General Extension&quot;) OR row(19).ToString.Equals(&quot;T2: Tier 2 General&quot;)]" sap:VirtualizedContainerService.HintSize="464,209" sap2010:WorkflowViewState.IdRef="If_75">
                                                        <If.Then>
                                                          <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{row(0).ToString,row(1).ToString,&quot;Leaver&quot;}]" DataTable="[dtLeavers]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddDataRow_1" />
                                                        </If.Then>
                                                      </If>
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ForEachRow.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ForEachRow>
                                        <ui:ExcelWriteRange AddHeaders="False" DataTable="[dtLeavers]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="663,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_12" SheetName="Leavers" StartingCell="A2" />
                                        <Delay Duration="00:00:02" sap:VirtualizedContainerService.HintSize="663,22" sap2010:WorkflowViewState.IdRef="Delay_7" />
                                        <Assign sap:VirtualizedContainerService.HintSize="663,60" sap2010:WorkflowViewState.IdRef="Assign_161">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:Int32">[intLeavers]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:Int32">[dtLeavers.Rows.Count]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                      </Sequence>
                                      <Sequence DisplayName="Create Joiners Sheet" sap:VirtualizedContainerService.HintSize="845,52" sap2010:WorkflowViewState.IdRef="Sequence_178">
                                        <Sequence.Variables>
                                          <Variable x:TypeArguments="sd:DataTable" Name="dtLeavers" />
                                          <Variable x:TypeArguments="sd:DataTable" Name="dtJoiners" />
                                        </Sequence.Variables>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:BuildDataTable DataTable="[dtJoiners]" DisplayName="Build Data Table" sap:VirtualizedContainerService.HintSize="663,59" sap2010:WorkflowViewState.IdRef="BuildDataTable_2" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;Employee_x0020_Number&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Name&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Employment_x0020_Status&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
                                        <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtSF16Data]" DisplayName="Check Changes" sap:VirtualizedContainerService.HintSize="663,954" sap2010:WorkflowViewState.IdRef="ForEachRow_13">
                                          <ui:ForEachRow.Body>
                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="633,806" sap2010:WorkflowViewState.IdRef="Sequence_177">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="611,60" sap2010:WorkflowViewState.IdRef="Assign_148">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="sd:DataRow[]">[arrFilteredRows]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="sd:DataRow[]">[Nothing]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="611,60" sap2010:WorkflowViewState.IdRef="Assign_149">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="sd:DataRow[]">[arrFilteredRows]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="sd:DataRow[]">[dtOLDSF16.Select("[Employee Number] = '"+row(0).ToString+"'")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <If Condition="[arrFilteredRows.Length&gt;0]" DisplayName="If Filtered Table has no data" sap:VirtualizedContainerService.HintSize="611,482" sap2010:WorkflowViewState.IdRef="If_83">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Else>
                                                    <Sequence DisplayName="Table Has no Data" sap:VirtualizedContainerService.HintSize="486,333" sap2010:WorkflowViewState.IdRef="Sequence_176">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If Condition="[row(19).ToString.Equals(&quot;T2: Tier  2 General Extension&quot;) OR row(19).ToString.Equals(&quot;T2: Tier 2 General&quot;)]" sap:VirtualizedContainerService.HintSize="464,209" sap2010:WorkflowViewState.IdRef="If_82">
                                                        <If.Then>
                                                          <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{row(0).ToString,row(1).ToString,&quot;Joiner&quot;}]" DataTable="[dtJoiners]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddDataRow_2" />
                                                        </If.Then>
                                                      </If>
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ForEachRow.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ForEachRow>
                                        <ui:ExcelWriteRange AddHeaders="False" DataTable="[dtJoiners]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="663,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_20" SheetName="Joiners" StartingCell="A2" />
                                        <Delay Duration="00:00:02" sap:VirtualizedContainerService.HintSize="663,22" sap2010:WorkflowViewState.IdRef="Delay_8" />
                                        <Assign sap:VirtualizedContainerService.HintSize="663,60" sap2010:WorkflowViewState.IdRef="Assign_162">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:Int32">[intJoiners]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:Int32">[dtJoiners.Rows.Count]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                      </Sequence>
                                      <Sequence DisplayName="Update Dashboard" sap:VirtualizedContainerService.HintSize="845,52" sap2010:WorkflowViewState.IdRef="Sequence_179">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:ExcelWriteCell Cell="C26" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_1" SheetName="Dashboard" Text="[intEmailsSent.ToString]" />
                                        <Delay Duration="00:00:02" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="Delay_9" />
                                        <ui:ExcelWriteCell Cell="C27" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_2" SheetName="Dashboard" Text="[intLeavers.ToString]" />
                                        <Delay Duration="00:00:02" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="Delay_10" />
                                        <ui:ExcelWriteCell Cell="C28" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_3" SheetName="Dashboard" Text="[intJoiners.ToString]" />
                                        <Delay Duration="00:00:02" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="Delay_11" />
                                        <ui:ExcelWriteCell Cell="C29" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_4" SheetName="Dashboard" Text="[(intCommentCount-1).ToString]" />
                                        <Delay Duration="00:00:02" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="Delay_12" />
                                      </Sequence>
                                      <ui:ExcelSaveWorkbook DisplayName="Save Workbook" sap:VirtualizedContainerService.HintSize="845,22" sap2010:WorkflowViewState.IdRef="ExcelSaveWorkbook_1" />
                                    </Sequence>
                                  </ActivityAction>
                                </ui:ExcelApplicationScope.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:ExcelApplicationScope>
                              <Assign sap:VirtualizedContainerService.HintSize="414,60" sap2010:WorkflowViewState.IdRef="Assign_12">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Int32">[intTransactionID]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Int32">[intTransactionID+1]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </TryCatch.Try>
                          <TryCatch.Catches>
                            <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="440,22" sap2010:WorkflowViewState.IdRef="Catch`1_3">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Business Rule Exception" sap:VirtualizedContainerService.HintSize="336,315" sap2010:WorkflowViewState.IdRef="Sequence_8">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_5" Level="Info" Message="[&quot;Business Rule Exception: &quot;+exception.Message]" />
                                  <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_7">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Boolean">[boolBusinessRuleExceptionThrown]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </Sequence>
                              </ActivityAction>
                            </Catch>
                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="440,22" sap2010:WorkflowViewState.IdRef="Catch`1_4">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ActivityAction x:TypeArguments="s:Exception">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Exception" sap:VirtualizedContainerService.HintSize="336,315" sap2010:WorkflowViewState.IdRef="Sequence_9">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:LogMessage DisplayName="Log message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_6" Level="Info" Message="[&quot;Exception: &quot;+exception.Message]" />
                                  <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_8">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Boolean">[boolExceptionThrown]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </Sequence>
                              </ActivityAction>
                            </Catch>
                          </TryCatch.Catches>
                        </TryCatch>
                      </State.Entry>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">194.25,422</av:Point>
                          <av:Size x:Key="ShapeSize">151.5,116</av:Size>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Double x:Key="StateContainerWidth">137.5</x:Double>
                          <x:Double x:Key="StateContainerHeight">80</x:Double>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <State.Transitions>
                        <Transition DisplayName="No More Data" sap:VirtualizedContainerService.HintSize="430,752" sap2010:WorkflowViewState.IdRef="Transition_1">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:PointCollection x:Key="ConnectorLocation">270,538 270,599.5</av:PointCollection>
                              <x:Int32 x:Key="SrcConnectionPointIndex">39</x:Int32>
                              <x:Int32 x:Key="DestConnectionPointIndex">38</x:Int32>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Transition.To>
                            <State x:Name="__ReferenceID0" DisplayName="Final" sap:VirtualizedContainerService.HintSize="114,61" sap2010:WorkflowViewState.IdRef="State_1" IsFinal="True">
                              <State.Entry>
                                <Sequence DisplayName="Clean Up" sap:VirtualizedContainerService.HintSize="336,455" sap2010:WorkflowViewState.IdRef="Sequence_12">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Sequence DisplayName="Comment/Description" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="Sequence_18">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:Comment sap:VirtualizedContainerService.HintSize="314,250.5" sap2010:WorkflowViewState.IdRef="Comment_4" Text="The final state should be used to clean up the process trail such as closing applications and moving files int the correct folders. It should provide a clear slate for the next time the process is run.&#xA;&#xA;On any exceptions that stop the whole process, the final state should still be executed so that any other processes arent affected by the files and any open applications." />
                                  </Sequence>
                                  <ui:SendOutlookMail Bcc="{x:Null}" Cc="{x:Null}" MailMessage="{x:Null}" TimeoutMS="{x:Null}" Account="rpa@edfenergy.com" Body="&lt;p&gt;Hello,&lt;/p&gt;&lt;p&gt;The Immigration and Visa Checks process has completed successfully.&lt;/p&gt;&lt;p&gt;You can view the output files here: &lt;a href='file://\\customer\shared\Grosvenor\Employee%20Services\ES Immigration\Immigration\Robotics\Reports'&gt;\\customer\Shared\Grosvenor\Employee Services\ES Immigration\Immigration\Robotics\Reports&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Kind Regards,&lt;/p&gt;&lt;p&gt;FSS ROBOT&lt;/p&gt;" DisplayName="Send Outlook Mail Message" sap:VirtualizedContainerService.HintSize="314,147" sap2010:WorkflowViewState.IdRef="SendOutlookMail_5" IsBodyHtml="True" IsDraft="False" Subject="RPA Process: Immigration and Visa Checks Completed" To="[strCCEmail]">
                                    <ui:SendOutlookMail.Files>
                                      <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                    </ui:SendOutlookMail.Files>
                                  </ui:SendOutlookMail>
                                  <Sequence DisplayName="Close Applications" sap:VirtualizedContainerService.HintSize="314,52" sap2010:WorkflowViewState.IdRef="Sequence_10">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:KillProcess Process="{x:Null}" ContinueOnError="True" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="KillProcess_2" ProcessName="excel" />
                                  </Sequence>
                                </Sequence>
                              </State.Entry>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <av:Point x:Key="ShapeLocation">213,599.5</av:Point>
                                  <av:Size x:Key="ShapeSize">114,61</av:Size>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </State>
                          </Transition.To>
                          <Transition.Action>
                            <Sequence sap:VirtualizedContainerService.HintSize="336,350" sap2010:WorkflowViewState.IdRef="Sequence_21">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:LogMessage sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_7" Level="Info" Message="[&quot;Finished State: Process Data&quot;]" />
                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_19" Level="Info" Message="[&quot;No More Items to Process.&quot;]" />
                            </Sequence>
                          </Transition.Action>
                          <Transition.Condition>[intTransactionID &gt; intTransactionCount]</Transition.Condition>
                        </Transition>
                        <Transition DisplayName="Exception" sap:VirtualizedContainerService.HintSize="430,512" sap2010:WorkflowViewState.IdRef="Transition_2">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:PointCollection x:Key="ConnectorLocation">194.25,485.8 113.054226475279,485.8 113.054226475279,617.8 213,617.8</av:PointCollection>
                              <x:Int32 x:Key="SrcConnectionPointIndex">41</x:Int32>
                              <x:Int32 x:Key="DestConnectionPointIndex">21</x:Int32>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Transition.To>
                            <x:Reference>__ReferenceID0</x:Reference>
                          </Transition.To>
                          <Transition.Action>
                            <ui:LogMessage sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_8" Level="Info" Message="[&quot;Failed State: Process Data&quot;]" />
                          </Transition.Action>
                          <Transition.Condition>[boolBusinessRuleExceptionThrown OR boolExceptionThrown]</Transition.Condition>
                        </Transition>
                        <Transition DisplayName="More Data" sap:VirtualizedContainerService.HintSize="430,752" sap2010:WorkflowViewState.IdRef="Transition_7">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:PointCollection x:Key="ConnectorLocation">345.75,462.6 375.75,462.6 375.75,310 348.5,310</av:PointCollection>
                              <x:Int32 x:Key="SrcConnectionPointIndex">24</x:Int32>
                              <x:Int32 x:Key="DestConnectionPointIndex">36</x:Int32>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Transition.To>
                            <x:Reference>__ReferenceID1</x:Reference>
                          </Transition.To>
                          <Transition.Action>
                            <Sequence DisplayName="More Data" sap:VirtualizedContainerService.HintSize="336,350" sap2010:WorkflowViewState.IdRef="Sequence_20">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_15" Level="Info" Message="[&quot;Finished State: Process Data&quot;]" />
                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_14" Level="Info" Message="[&quot;Moving to next item.&quot;]" />
                            </Sequence>
                          </Transition.Action>
                          <Transition.Condition>[intTransactionID &lt;= intTransactionCount]</Transition.Condition>
                        </Transition>
                      </State.Transitions>
                      <State.Variables>
                        <Variable x:TypeArguments="x:String" Name="strComment" />
                        <Variable x:TypeArguments="x:String" Name="strCurrentDate" />
                        <Variable x:TypeArguments="x:String" Name="strRowIndex" />
                        <Variable x:TypeArguments="s:DateTime" Name="dateFilter" />
                        <Variable x:TypeArguments="x:Int32" Name="intLeavers" />
                        <Variable x:TypeArguments="x:Int32" Name="intJoiners" />
                      </State.Variables>
                    </State>
                  </Transition.To>
                  <Transition.Action>
                    <Sequence sap:VirtualizedContainerService.HintSize="336,217" sap2010:WorkflowViewState.IdRef="Sequence_13">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:LogMessage sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_9" Level="Info" Message="[&quot;Finished State: Get Data&quot;]" />
                    </Sequence>
                  </Transition.Action>
                  <Transition.Condition>True</Transition.Condition>
                </Transition>
                <Transition DisplayName="Exception" sap:VirtualizedContainerService.HintSize="594.5,512" sap2010:WorkflowViewState.IdRef="Transition_4">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:PointCollection x:Key="ConnectorLocation">191.5,344.2 65.2264752791069,344.2 65.2264752791069,651.35 213,651.35</av:PointCollection>
                      <x:Int32 x:Key="SrcConnectionPointIndex">61</x:Int32>
                      <x:Int32 x:Key="DestConnectionPointIndex">65</x:Int32>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Transition.To>
                    <x:Reference>__ReferenceID0</x:Reference>
                  </Transition.To>
                  <Transition.Action>
                    <ui:LogMessage sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_10" Level="Info" Message="[&quot;Failed State: Get Data&quot;]" />
                  </Transition.Action>
                  <Transition.Condition>[intRetryCount &gt;= intMaxRetries OR boolBusinessRuleExceptionThrown OR boolExceptionThrown]</Transition.Condition>
                </Transition>
                <Transition DisplayName="Failed" sap:VirtualizedContainerService.HintSize="430,852" sap2010:WorkflowViewState.IdRef="Transition_5">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:PointCollection x:Key="ConnectorLocation">348.5,270.1 378.5,270.1 378.5,150 351,150</av:PointCollection>
                      <x:Int32 x:Key="SrcConnectionPointIndex">8</x:Int32>
                      <x:Int32 x:Key="DestConnectionPointIndex">36</x:Int32>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Transition.To>
                    <x:Reference>__ReferenceID2</x:Reference>
                  </Transition.To>
                  <Transition.Action>
                    <Sequence DisplayName="Report Not Found" sap:VirtualizedContainerService.HintSize="336,450" sap2010:WorkflowViewState.IdRef="Sequence_14">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_9">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:Int32">[intRetryCount]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:Int32">[intRetryCount+1]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:LogMessage sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_11" Level="Info" Message="[&quot;Restarting State: Get Data&quot;]" />
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_13" Level="Info" Message="[&quot;Retry Count: &quot;+intRetryCount.ToString]" />
                    </Sequence>
                  </Transition.Action>
                  <Transition.Condition>[intRetryCount&lt;intMaxRetries]</Transition.Condition>
                </Transition>
              </State.Transitions>
            </State>
          </Transition.To>
          <Transition.Action>
            <ui:LogMessage sap:VirtualizedContainerService.HintSize="314,93" sap2010:WorkflowViewState.IdRef="LogMessage_12" Level="Info" Message="[&quot;Finished State: Initialisation&quot;]" />
          </Transition.Action>
          <Transition.Condition>[boolInitComplete]</Transition.Condition>
        </Transition>
      </State.Transitions>
    </State>
    <x:Reference>__ReferenceID1</x:Reference>
    <x:Reference>__ReferenceID0</x:Reference>
    <x:Reference>__ReferenceID3</x:Reference>
    <StateMachine.Variables>
      <Variable x:TypeArguments="x:Int32" Name="intMaxRetries" />
      <Variable x:TypeArguments="x:Boolean" Name="boolBusinessRuleExceptionThrown" />
      <Variable x:TypeArguments="x:Boolean" Name="boolExceptionThrown" />
      <Variable x:TypeArguments="x:Boolean" Name="boolInitComplete" />
      <Variable x:TypeArguments="x:Int32" Name="intTransactionID" />
      <Variable x:TypeArguments="x:String" Name="strFolderPath" />
      <Variable x:TypeArguments="x:String" Name="strTemplatePath" />
      <Variable x:TypeArguments="x:String" Name="strReportsFolderPath" />
      <Variable x:TypeArguments="x:String" Name="strReportPath" />
      <Variable x:TypeArguments="x:String" Name="strReportWithAnalysisPath" />
      <Variable x:TypeArguments="x:String" Name="strArchiveFolderPath" />
      <Variable x:TypeArguments="x:String" Name="strPreviousReportPath" />
      <Variable x:TypeArguments="x:String" Name="strUsername" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtNewILRPR" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtNewLimitedLeave" />
      <Variable x:TypeArguments="x:Int32" Default="0" Name="intRetryCount" />
      <Variable x:TypeArguments="sd:DataRow[]" Name="arrFilteredRows" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtSF16Data" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtOLDSF16" />
      <Variable x:TypeArguments="x:Int32" Name="intTransactionCount" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtOLDSF16Filtered" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtOLDLimitedLeave" />
      <Variable x:TypeArguments="x:String" Name="strCCEmail" />
      <Variable x:TypeArguments="x:Int32" Name="intEmailsSent" />
      <Variable x:TypeArguments="x:Int32" Name="intCommentCount" />
    </StateMachine.Variables>
  </StateMachine>
</Activity>